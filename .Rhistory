inspect(cc_reduced)
cc_reduced %>%
gf_boxplot(median_household_income~pop_gain)
cc_reduced %>%
gf_boxplot(median_household_income~pop_gain,subtitle="The income data were collected between 2006 and 2010.")
cc_reduced %>%
gf_boxplot(median_household_income~pop_gain,subtitle="The income data were collected between 2006 and 2010.",xlab="Population change from 2000 to 2010")
cc_reduced %>%
gf_boxplot(median_household_income~pop_gain,
subtitle="The income data were collected between 2006 and 2010.",
xlab="Population change from 2000 to 2010",
ylab="Median Household Income")
cc_reduced %>%
gf_density(~median_household_income,color=~pop_gain)
cc_reduced %>%
gf_dens(~median_household_income,color=~pop_gain)
?gf_dens
cc_reduced %>%
gf_dens(~median_household_income,color=~pop_gain,lwd=2)
cc_reduced %>%
gf_dens(~median_household_income,color=~pop_gain,lwd=1)
library(openintro)
mammals
favstat(mammals)
favstats(mammals)
inspect(mammals)
library(mosaic)
inspect(mammals)
?mammals
gf_histogram(~TotalSleep,data=mammals)
gf_boxplot(~TotalSleep,data=mammals)
gf_dens(~TotalSleep,data=mammals)
gf_dens(~BrainWt,data=mammals)
gf_dens(~BodyWt,data=mammals)
gf_histogram(~BodyWt,data=mammals)
gf_boxplot(~BodyWt,data=mammals)
gf_boxplot(~TotalSleep,data=mammals)
gf_dens(~TotalSleep,data=mammals)
gf_dens(~LifeSpan,data=mammals)
gf_boxplot(~LifeSpan,data=mammals)
favstats(LifeSpan~Danger,data=mammals)
gf_boxplot(LifeSpan~Exposure,data=mammals)
gf_boxplot(LifeSpan~factor(Exposure),data=mammals)
favstats(LifeSpan~Exposure,data=mammals)
gf_dens(LifeSpan~factor(Exposure),data=mammals)
gf_dens(~LifeSpan,color=factor(Exposure),data=mammals)
gf_dens(~LifeSpan,color=factor(~Exposure),data=mammals)
gf_dens(~LifeSpan,data=mammals)
gf_dens(~LifeSpan,group=factor(Exposrue),data=mammals)
gf_dens(~LifeSpan,group=factor(Exposure),data=mammals)
gf_dens(~LifeSpan,group=~factor(Exposure),data=mammals)
gf_dens(~LifeSpan,color=~factor(Exposure),data=mammals)
knitr::opts_chunk$set(echo = TRUE)
gf_dens(~TotalSleep,data=mammals)
gf_boxplot(~LifeSpan,data=mammals)
mean(~LifeSpan,data=mammals)
mean(~LifeSpan,data=mammals,na.rm=TRUE)
median(~LifeSpan,data=mammals,na.rm=TRUE)
favstats(LifeSpan~Danger,data=mammals)
mammals %>%
gf_boxplot(LifeSpan~Exposure)
mammals %>%
gf_boxplot(LifeSpan~factor(Exposure))
favstats(LifeSpan~factor(Exposure),data=mammals)
gf_dens(~LifeSpan,color=~factor(Exposure),data=mammals)
gf_dens(~LifeSpan,color=~factor(Exposure),data=mammals)
gf_dens(~LifeSpan,color=~factor(Exposure),data=mammals)
mammals %>%
mutate(Exposed=ifelse((Exposure==1)|(Exposure==2),"Low","High"))
mammals %>%
mutate(Exposed=factor(ifelse((Exposure==1)|(Exposure==2),"Low","High")))
mammals <- mammals %>%
mutate(Exposed=factor(ifelse((Exposure==1)|(Exposure==2),"Low","High")))
inspect(mammals)
gf_dens(~LifeSpan,color=~Exposed,data=mammals)
mammals %>%
gf_point(LifeSpan~Gestation)
mammals %>%
gf_point(Gestation~LifeSpan)
knitr::opts_chunk$set(echo = TRUE)
library(openintro)
library(mosaic)
library(tidyverse)
pbirthday(18)
head(births)
library(mosaic)
head(Births)
dim(Births)
?Births
Briths %>%
group_by(day_of_year) %>%
summarise(n=n(births))
Births %>%
group_by(day_of_year) %>%
summarise(n=n(births))
Births %>%
group_by(day_of_year) %>%
summarise(n=sum(births))
knitr::opts_chunk$set(echo = TRUE)
Births %>%
group_by(year) %>%
summarise(n=sum(day_of_year))
Births %>%
group_by(year) %>%
summarise(n=n(day_of_year))
Births %>%
group_by(year) %>%
summarise(n=n())
seq( as.Date("2005-01-01"), as.Date("2005-12-31"), by="+1 day")
as.character(seq( as.Date("2005-01-01"), as.Date("2005-12-31"), by="+1 day"),format="%B %Y")
as.character(seq( as.Date("2005-01-01"), as.Date("2005-12-31"), by="+1 day"),format="%B %d")
as.character(seq( as.Date("2005-01-01"), as.Date("2005-12-31"), by=365),format="%B %d")
as.character(seq( as.Date("2005-01-01"), as.Date("2005-12-31"), by=1),format="%B %d")
1:365
seq(1,365)
?sample
days <- seq(1,365)
set.seed(2022)
sample(days,1)
class <- sample(days,size=18,replace = TRUE)
class <- sample(days,size=18,replace = TRUE)
class
set.seed(2022)
sample(days,1)
class <- sample(days,size=18,replace = TRUE)
class
sort(class)
library(mosaie)
library(mosaic)
sort(class)
unique(class)
length(unique(class))
length(unique(sample(days,size=18,replace = TRUE)))
library(mosaic)
do(5)*length(unique(sample(days,size=18,replace = TRUE)))
do(1000)*length(unique(sample(days,size=18,replace = TRUE))) %>%
mutate(match=if_else(length==18,0,1)) %>%
summarise(prob=mean(match))
class(do(5)*length(unique(sample(days,size=18,replace = TRUE))))
do(5)*length(unique(sample(days,size=18,replace = TRUE)))
temp <- do(1000)*length(unique(sample(days,size=18,replace = TRUE)))
temp %>%
mutate(match=if_else(length==18,0,1)) %>%
summarise(prob=mean(match))
(do(1000)*length(unique(sample(days,size=18,replace = TRUE)))) %>%
mutate(match=if_else(length==18,0,1)) %>%
summarise(prob=mean(match))
(do(1000)*length(unique(sample(days,size=18,replace = TRUE)))) %>%
mutate(match=if_else(length==18,0,1)) %>%
summarise(prob=mean(match))
(do(1000)*length(unique(sample(days,size=18,replace = TRUE)))) %>%
mutate(match=if_else(length==18,0,1)) %>%
summarise(prob=mean(match))
(do(1000)*length(unique(sample(days,size=18,replace = TRUE)))) %>%
mutate(match=if_else(length==18,0,1)) %>%
summarise(prob=mean(match))
(do(1000)*length(unique(sample(days,size=18,replace = TRUE)))) %>%
mutate(match=if_else(length==18,0,1)) %>%
summarise(prob=mean(match))
(do(1000)*length(unique(sample(days,size=18,replace = TRUE)))) %>%
mutate(match=if_else(length==18,0,1)) %>%
summarise(prob=mean(match))
(do(10000)*length(unique(sample(days,size=18,replace = TRUE)))) %>%
mutate(match=if_else(length==18,0,1)) %>%
summarise(prob=mean(match))
(do(1000)*length(unique(sample(days,size=18,replace = TRUE)))) %>%
mutate(match=if_else(length==18,0,1)) %>%
summarise(prob=mean(match))
(do(10000)*length(unique(sample(days,size=18,replace = TRUE)))) %>%
mutate(match=if_else(length==18,0,1)) %>%
summarise(prob=mean(match))
(do(1000)*length(unique(sample(days,size=18,replace = TRUE)))) %>%
tally(~length,data=.)
(do(1000)*length(unique(sample(days,size=18,replace = TRUE)))) %>%
tally(~length,data=.) %>%
gf_bar(~length)
(do(1000)*length(unique(sample(days,size=18,replace = TRUE)))) %>%
gf_bar(~length)
365-17
?factorial
knitr::opts_chunk$set(echo = TRUE)
1- 365^18/factorial(365)/factorial(348)
1- (365^18/factorial(365)/factorial(348))
1- ((365^18)/factorial(365)/factorial(348))
365^18
factorial(365)/factorial(348)
factorial(365)
pbirthday
factorial(36)
365-18
365-17
365-18-1
365-2-1
365-2
365-18
365-2
365-17
365-18
?choose
?prod
prod(365:364)
365*364
365*364*363
prod(365:363)
factorial(365)
365*364
prod(365:364)
pbirthday(18)
1- prod(365:347)/(365^18)
prod(365:347)
(365^18)
choose(365, 365 - 18) * factorial(18)
1- prod(365:348)/(365^18)
365-18
birthday_prob <- function(n=20){
1- prod(365:(365-(n-1)))/(365^n)
}
birthday_prob(18)
birthday_prob(18)
sapply(1:120,birthday_prob)
lapply(1:120,birthday_prob)
sapply(1:120,birthday_prob)
?sapply
birthday_prob(23)
?Vectorize
birthday_prob(1:20)
birthday_prob <- Vectorize(birthday_prob)
birthday_prob(1:20)
library(mosaic)
library(mosaic)
library(tidyverse)
gf_point(birthday_prob(1:100)~ seq(1,100))
gf_line(birthday_prob(1:100)~ seq(1,100))
gf_line(birthday_prob(1:100)~ seq(1,100),xlab="Number of People")
gf_line(birthday_prob(1:100)~ seq(1,100),xlab="Number of People",ylab="Probability of Match",title="Probability of at least 2 people with matching birthdays")
?Births
?Births2015
glimpse(Births)
inspect(Births)
Births %>%
group_by(year) %>%
summarise(n=n())
Births %>%
filter(year == 1969) %>%
gf_point(births~day_of_year)
Births %>%
filter(year == 1969) %>%
gf_point(births~day_of_year,color=~day_of_week)
Births %>%
filter(year == 1969) %>%
gf_point(births~day_of_year,color=~factor(day_of_week))
Births %>%
filter(year == 1969) %>%
gf_point(births~day_of_year)
Births %>%
filter(year == 1969) %>%
gf_point(births~day_of_year,color=~factor(day_of_week))
Births %>%
group_by(day_of_year) %>%
summarise(n=sum(births))
Births %>%
group_by(year) %>%
summarise(n=n())
Births %>%
filter(!(year %in% c(1972,1976,1980,1984,1988))) %>%
group_by(year) %>%
summarise(n=n())
birth_data <- Births %>%
filter(!(year %in% c(1972,1976,1980,1984,1988))) %>%
group_by(day_of_year) %>%
summarise(n=sum(births))
head(birth_data)
?sample
?sample
birth_data %>%
sample_n(size=18,replace=TRUE,weight=n)
?sample
sample(birth_data,size=18,replace=TRUE,weight=n)
sample(birth_data,size=18,replace=TRUE,weight=n,orig.ids = FALSE)
sample(birth_data,size=18,replace=TRUE,weight=n,orig.ids = FALSE) %>%
select(day_of_year)
sample(birth_data,size=18,replace=TRUE,weight=n,orig.ids = FALSE) %>%
select(day_of_year) %>%
unique()
sample(birth_data,size=18,replace=TRUE,weight=n,orig.ids = FALSE) %>%
select(day_of_year) %>%
unique()
sample(birth_data,size=18,replace=TRUE,weight=n,orig.ids = FALSE) %>%
select(day_of_year) %>%
unique() %>%
length()
birth_data_weights <- Births %>%
filter(!(year %in% c(1972,1976,1980,1984,1988))) %>%
group_by(day_of_year) %>%
summarise(n=sum(births)) %>%
select(n)
head(birth_data_weights)
sample(days,size=18,replace = TRUE,weights=birth_data_weights)
(do(1000)*length(unique(sample(days,size=18,replace = TRUE,weights=birth_data_weights)))) %>%
mutate(match=if_else(length==18,0,1)) %>%
summarise(prob=mean(match))
(do(1000)*length(unique(sample(days,size=18,replace = TRUE,weights=birth_data_weights)))) %>%
mutate(match=if_else(length==18,0,1)) %>%
summarise(prob=mean(match))
(do(1000)*length(unique(sample(days,size=18,replace = TRUE,weights=birth_data_weights)))) %>%
mutate(match=if_else(length==18,0,1)) %>%
summarise(prob=mean(match))
set.seed(1)
(do(1000)*length(unique(sample(days,size=18,replace = TRUE,weights=birth_data_weights)))) %>%
mutate(match=if_else(length==18,0,1)) %>%
summarise(prob=mean(match))
set.seed(1)
(do(1000)*length(unique(sample(days,size=18,replace = TRUE)))) %>%
mutate(match=if_else(length==18,0,1)) %>%
summarise(prob=mean(match))
birth_data_weights <- Births %>%
filter(!(year %in% c(1972,1976,1980,1984,1988))) %>%
group_by(day_of_year) %>%
summarise(n=sum(births)) %>%
gf_line(n~day_of_year)
birth_data_weights <- Births %>%
filter(!(year %in% c(1972,1976,1980,1984,1988))) %>%
group_by(day_of_year) %>%
summarise(n=sum(births)) %>%
gf_line(n~day_of_year)
birth_data_weights <- Births %>%
filter(!(year %in% c(1972,1976,1980,1984,1988))) %>%
group_by(day_of_year) %>%
summarise(n=sum(births)) %>%
gf_line(n~day_of_year)
birth_data_weights <- Births %>%
filter(!(year %in% c(1972,1976,1980,1984,1988))) %>%
group_by(day_of_year) %>%
summarise(n=sum(births))
Births %>%
filter(!(year %in% c(1972,1976,1980,1984,1988))) %>%
group_by(day_of_year) %>%
summarise(n=sum(births)) %>%
gf_line(n~day_of_year)
Births %>%
filter(!(year %in% c(1972,1976,1980,1984,1988))) %>%
group_by(day_of_year) %>%
summarise(n=sum(births))
Births %>%
filter(!(year %in% c(1972,1976,1980,1984,1988))) %>%
group_by(day_of_year) %>%
summarise(n=sum(births)) %>%
gf_line(n~day_of_year)
birth_data <- Births %>%
filter(!(year %in% c(1972,1976,1980,1984,1988))) %>%
group_by(day_of_year) %>%
summarise(n=sum(births))
birth_data <- Births %>%
filter(!(year %in% c(1972,1976,1980,1984,1988))) %>%
group_by(day_of_year) %>%
summarise(n=sum(births))
head(birth_data_weights)
head(birth_data)
birth_data %>%
gf_line(n~day_of_year)
birth_data %>%
gf_line(n~day_of_year,xlab="Day of the year",ylab="Number of births")
birth_data %>%
gf_line(n~day_of_year,xlab="Day of the year",ylab="Number of births") %>%
gf_vline(xintercept = 359)
?gf_vline
birth_data %>%
gf_line(n~day_of_year,xlab="Day of the year",ylab="Number of births") %>%
gf_vline(xintercept = ~359)
birth_data_weights <- birth_data %>%
select(n)
birth_data_weights
birth_data_weights <- birth_data %>%
select(n) %>%
pull()
birth_data_weights
sample(days,size=18,replace = TRUE,weights=birth_data_weights)
set.seed(1)
(do(1000)*length(unique(sample(days,size=18,replace = TRUE,weights=birth_data_weights)))) %>%
mutate(match=if_else(length==18,0,1)) %>%
summarise(prob=mean(match))
set.seed(1)
(do(1000)*length(unique(sample(days,size=18,replace = TRUE)))) %>%
mutate(match=if_else(length==18,0,1)) %>%
summarise(prob=mean(match))
set.seed(1)
(do(1000)*length(unique(sample(days,size=18,replace = TRUE,prob=birth_data_weights)))) %>%
mutate(match=if_else(length==18,0,1)) %>%
summarise(prob=mean(match))
set.seed(1)
(do(1000)*length(unique(sample(days,size=18,replace = TRUE)))) %>%
mutate(match=if_else(length==18,0,1)) %>%
summarise(prob=mean(match))
set.seed(2020)
(do(1000)*length(unique(sample(days,size=18,replace = TRUE,prob=birth_data_weights)))) %>%
mutate(match=if_else(length==18,0,1)) %>%
summarise(prob=mean(match))
set.seed(2020)
(do(10000)*length(unique(sample(days,size=18,replace = TRUE,prob=birth_data_weights)))) %>%
mutate(match=if_else(length==18,0,1)) %>%
summarise(prob=mean(match))
set.seed(2020)
(do(10000)*length(unique(sample(days,size=18,replace = TRUE)))) %>%
mutate(match=if_else(length==18,0,1)) %>%
summarise(prob=mean(match))
set.seed(2020)
(do(10000)*length(unique(sample(days,size=18,replace = TRUE,prob=birth_data_weights)))) %>%
mutate(match=if_else(length==18,0,1)) %>%
summarise(prob=mean(match))
set.seed(20)
(do(10000)*length(unique(sample(days,size=18,replace = TRUE)))) %>%
mutate(match=if_else(length==18,0,1)) %>%
summarise(prob=mean(match))
set.seed(20)
(do(10000)*length(unique(sample(days,size=18,replace = TRUE,prob=birth_data_weights)))) %>%
mutate(match=if_else(length==18,0,1)) %>%
summarise(prob=mean(match))
pbirthday(18)
set.seed(20)
(do(100000)*length(unique(sample(days,size=18,replace = TRUE,prob=birth_data_weights)))) %>%
mutate(match=if_else(length==18,0,1)) %>%
summarise(prob=mean(match))
pbirthday(18)
set.seed(20)
(do(1000)*length(unique(sample(days,size=18,replace = TRUE,prob=birth_data_weights)))) %>%
mutate(match=if_else(length==18,0,1)) %>%
summarise(prob=mean(match))
(do(1000)*length(unique(sample(days,size=23,replace = TRUE)))) %>%
mutate(match=if_else(length==22,0,1)) %>%
summarise(prob=mean(match))
knitr::opts_chunk$set(echo = TRUE)
(do(1000)*length(unique(sample(days,size=23,replace = TRUE)))) %>%
gf_bar(~length)
(do(10000)*length(unique(sample(days,size=23,replace = TRUE)))) %>%
mutate(match=if_else(length==22,0,1)) %>%
summarise(prob=mean(match))
(do(10000)*length(unique(sample(days,size=23,replace = TRUE)))) %>%
mutate(match=if_else(length==23,0,1)) %>%
summarise(prob=mean(match))
(do(10000)*length(unique(sample(days,size=23,replace = TRUE)))) %>%
mutate(match=if_else(length==22,1,0)) %>%
summarise(prob=mean(match))
1 - prod(365)/365^
1 - prod(365)/365^2
prod(365)/365^2
(do(10000)*length(unique(sample(days,size=2,replace = TRUE)))) %>%
mutate(match=if_else(length==2,1,0)) %>%
summarise(prob=mean(match))
(do(10000)*length(unique(sample(days,size=2,replace = TRUE)))) %>%
mutate(match=if_else(length==2,0,1)) %>%
summarise(prob=mean(match))
(do(1000)*length(unique(sample(days,size=23,replace = TRUE)))) %>%
gf_bar(~length)
(do(1000)*length(unique(sample(days,size=23,replace = TRUE)))) %>%
gf_bar(~length)
(do(10000)*length(unique(sample(days,size=23,replace = TRUE)))) %>%
mutate(match=if_else(length==22,0,1)) %>%
summarise(prob=mean(match))
(do(10000)*length(unique(sample(days,size=23,replace = TRUE)))) %>%
mutate(match=if_else(length==22,1,0)) %>%
summarise(prob=mean(match))
(do(10000)*length(unique(sample(days,size=23,replace = TRUE)))) %>%
mutate(match=if_else(length==22,1,0)) %>%
summarise(prob=mean(match))
(do(10000)*length(unique(sample(days,size=23,replace = TRUE)))) %>%
mutate(match=if_else(length==22,1,0)) %>%
summarise(prob=mean(match))
(do(10000)*length(unique(sample(days,size=23,replace = TRUE)))) %>%
mutate(match=if_else(length==22,1,0)) %>%
summarise(prob=mean(match))
(do(10000)*length(unique(sample(days,size=23,replace = TRUE)))) %>%
mutate(match=if_else(length==22,1,0)) %>%
summarise(prob=mean(match))
(do(1000)*length(unique(sample(days,size=23,replace = TRUE)))) %>%
gf_bar(~length)
(do(10000)*length(unique(sample(days,size=2,replace = TRUE)))) %>%
mutate(match=if_else(length==1,1,0)) %>%
summarise(prob=mean(match))
(do(10000)*length(unique(sample(days,size=2,replace = TRUE)))) %>%
mutate(match=if_else(length==1,1,0)) %>%
summarise(prob=mean(match))
(do(10000)*length(unique(sample(days,size=23,replace = TRUE)))) %>%
mutate(match=if_else(length==22,1,0)) %>%
summarise(prob=mean(match))
prod(365:364)/365^3
(do(10000)*length(unique(sample(days,size=3,replace = TRUE)))) %>%
mutate(match=if_else(length==2,1,0)) %>%
summarise(prob=mean(match))
prod(365:364)
prod(365:364)/365^3
3*prod(365:364)/365^3
(do(10000)*length(unique(sample(days,size=3,replace = TRUE)))) %>%
mutate(match=if_else(length==2,1,0)) %>%
summarise(prob=mean(match))
(do(100000)*length(unique(sample(days,size=3,replace = TRUE)))) %>%
mutate(match=if_else(length==2,1,0)) %>%
summarise(prob=mean(match))
(do(1000000)*length(unique(sample(days,size=3,replace = TRUE)))) %>%
mutate(match=if_else(length==2,1,0)) %>%
summarise(prob=mean(match))
(do(10000)*length(unique(sample(days,size=23,replace = TRUE)))) %>%
mutate(match=if_else(length==22,1,0)) %>%
summarise(prob=mean(match))
365-21
3*prod(365:344)/365^23
choose(23,2)*prod(365:344)/365^23
exactly_two <- function(n){
choose(n,2)*prod(365:(365-(n-2)))/365^n
}
exactly_two(23)
exactly_two <- Vectorize(exactly_two)
gf_line(exactly_two(1:100)~ seq(1,100),xlab="Number of People",ylab="Probability of Match",title="Probability of exactly least 2 people with matching birthdays")
