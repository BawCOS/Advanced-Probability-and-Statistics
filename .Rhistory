summarise(prob=mean(match))
(do(10000)*length(unique(sample(days,size=23,replace = TRUE)))) %>%
mutate(match=if_else(length==22,1,0)) %>%
summarise(prob=mean(match))
(do(1000)*length(unique(sample(days,size=23,replace = TRUE)))) %>%
gf_bar(~length)
(do(10000)*length(unique(sample(days,size=2,replace = TRUE)))) %>%
mutate(match=if_else(length==1,1,0)) %>%
summarise(prob=mean(match))
(do(10000)*length(unique(sample(days,size=2,replace = TRUE)))) %>%
mutate(match=if_else(length==1,1,0)) %>%
summarise(prob=mean(match))
(do(10000)*length(unique(sample(days,size=23,replace = TRUE)))) %>%
mutate(match=if_else(length==22,1,0)) %>%
summarise(prob=mean(match))
prod(365:364)/365^3
(do(10000)*length(unique(sample(days,size=3,replace = TRUE)))) %>%
mutate(match=if_else(length==2,1,0)) %>%
summarise(prob=mean(match))
prod(365:364)
prod(365:364)/365^3
3*prod(365:364)/365^3
(do(10000)*length(unique(sample(days,size=3,replace = TRUE)))) %>%
mutate(match=if_else(length==2,1,0)) %>%
summarise(prob=mean(match))
(do(100000)*length(unique(sample(days,size=3,replace = TRUE)))) %>%
mutate(match=if_else(length==2,1,0)) %>%
summarise(prob=mean(match))
(do(1000000)*length(unique(sample(days,size=3,replace = TRUE)))) %>%
mutate(match=if_else(length==2,1,0)) %>%
summarise(prob=mean(match))
(do(10000)*length(unique(sample(days,size=23,replace = TRUE)))) %>%
mutate(match=if_else(length==22,1,0)) %>%
summarise(prob=mean(match))
365-21
3*prod(365:344)/365^23
choose(23,2)*prod(365:344)/365^23
exactly_two <- function(n){
choose(n,2)*prod(365:(365-(n-2)))/365^n
}
exactly_two(23)
exactly_two <- Vectorize(exactly_two)
gf_line(exactly_two(1:100)~ seq(1,100),xlab="Number of People",ylab="Probability of Match",title="Probability of exactly least 2 people with matching birthdays")
knitr::opts_chunk$set(echo = TRUE)
(do(10)*table(sample(days,size=23,replace = TRUE))
do(10)*table(sample(days,size=23,replace = TRUE))
library(mosaic)
library(tidyverse)
do(10)*table(sample(days,size=23,replace = TRUE))
table(sample(days,size=23,replace = TRUE))
table(sample(days,size=23,replace = TRUE))
table(sample(days,size=23,replace = TRUE)) == 2
table(sample(days,size=23,replace = TRUE)) == 2
sum(table(sample(days,size=23,replace = TRUE)) == 2)
sum(table(sample(days,size=23,replace = TRUE)) == 2)
sum(table(sample(days,size=23,replace = TRUE)) == 2)
sum(table(sample(days,size=23,replace = TRUE)) == 2)
sum(table(sample(days,size=23,replace = TRUE)) == 2)
sum(table(sample(days,size=23,replace = TRUE)) == 2)
sum(table(sample(days,size=23,replace = TRUE)) == 2)
do(10)*sum(table(sample(days,size=23,replace = TRUE)) == 2)
do(10)*sum(table(sample(days,size=23,replace = TRUE)) == 2)
do(10)*(sum(table(sample(days,size=23,replace = TRUE)) == 2)==1)
do(10)*(sum(table(sample(days,size=23,replace = TRUE)) == 2)==1) %>%
summarise(prob=mean(result))
do(10)*((sum(table(sample(days,size=23,replace = TRUE)) == 2)==1)+0)
do(10)*((sum(table(sample(days,size=23,replace = TRUE)) == 2)==1)+0) %>%
summarise(prob=mean(result))
(do(10)*((sum(table(sample(days,size=23,replace = TRUE)) == 2)==1)+0)) %>%
summarise(prob=mean(result))
(do(100)*((sum(table(sample(days,size=23,replace = TRUE)) == 2)==1)+0)) %>%
summarise(prob=mean(result))
(do(1000)*((sum(table(sample(days,size=23,replace = TRUE)) == 2)==1)+0)) %>%
summarise(prob=mean(result))
(do(10000)*((sum(table(sample(days,size=23,replace = TRUE)) == 2)==1)+0)) %>%
summarise(prob=mean(result))
(do(10000)*((sum(table(sample(days,size=23,replace = TRUE)) == 3)==1)+0)) %>%
summarise(prob=mean(result))
(do(10000)*((sum(table(sample(days,size=23,replace = TRUE)) == 3)==1)+0)) %>%
summarise(prob=mean(result))
choose(23,3)*prod(365:345)/365^23
(do(10000)*((sum(table(sample(days,size=23,replace = TRUE)) == 3)==1)+0)) %>%
summarise(prob=mean(result))
choose(23,3)*prod(365:345)/365^23
(do(100000)*((sum(table(sample(days,size=23,replace = TRUE)) == 3)==1)+0)) %>%
summarise(prob=mean(result))
choose(23,3)*prod(365:345)/365^23
(do(100000)*((sum(table(sample(days,size=23,replace = TRUE)) == 3)==1)+0)) %>%
summarise(prob=mean(result))
(do(10000)*((sum(table(sample(days,size=23,replace = TRUE)) == 3)==1)+0)) %>%
summarise(prob=mean(result))
(do(10000)*((sum(table(sample(days,size=3,replace = TRUE)) == 3)==1)+0)) %>%
summarise(prob=mean(result))
1/365^2
(do(10000)*((sum(table(sample(days,size=3,replace = TRUE)) == 3)==1)+0)) %>%
summarise(prob=mean(result))
(do(10000)*((sum(table(sample(days,size=4,replace = TRUE)) == 3)==1)+0)) %>%
summarise(prob=mean(result))
(do(10000)*((sum(table(sample(days,size=5,replace = TRUE)) == 3)==1)+0)) %>%
summarise(prob=mean(result))
(do(10000)*((sum(table(sample(days,size=6,replace = TRUE)) == 3)==1)+0)) %>%
summarise(prob=mean(result))
choose(6,3)*prod(365:(365-3))/365^6
(do(10000)*((sum(table(sample(days,size=10,replace = TRUE)) == 3)==1)+0)) %>%
summarise(prob=mean(result))
choose(10,3)*prod(365:(365-7))/365^10
(do(10000)*((sum(table(sample(days,size=10,replace = TRUE)) == 3)==1)+0)) %>%
summarise(prob=mean(result))
choose(23,3)*prod(365:(365-20))/365^23
(do(10000)*((sum(table(sample(days,size=23,replace = TRUE)) == 3)==1)+0)) %>%
summarise(prob=mean(result))
(do(10000)*((sum(table(sample(days,size=23,replace = TRUE)) == 3)==1)+0)) %>%
summarise(prob=mean(result))
(do(10000)*((sum(table(sample(days,size=23,replace = TRUE)) == 3)==1)+0)) %>%
summarise(prob=mean(result))
set.seed(1)
(do(10)*((sum(table(sample(days,size=23,replace = TRUE)) == 3)==1)+0))
set.seed(1)
(do(10)*((sum(table(sample(days,size=23,replace = TRUE)) == 3)==1)+0))
set.seed(1)
(do(10)*((sum(table(sample(days,size=23,replace = TRUE)) == 3)==1)+0))
set.seed(1)
(do(10)*((sum(table(sample(days,size=23,replace = TRUE)) == 3)==1)+0))
set.seed(1)
(do(100)*((sum(table(sample(days,size=23,replace = TRUE)) == 3)==1)+0))
set.seed(1)
(do(100)*((sum(table(sample(days,size=23,replace = TRUE)) == 3)==1)+0)) %>%
summarise(prob=mean(result))
set.seed(1)
(do(400)*((sum(table(sample(days,size=23,replace = TRUE)) == 3)==1)+0)) %>%
summarise(prob=mean(result))
(do(10000)*((sum(table(sample(days,size=23,replace = TRUE)) == 3)==1)+0)) %>%
summarise(prob=mean(result))
table(sample(days,size=23,replace = TRUE)
table(sample(days,size=23,replace = TRUE))
set.seed(5)
table(sample(days,size=23,replace = TRUE))
set.seed(7)
table(sample(days,size=23,replace = TRUE))
set.seed(8)
table(sample(days,size=23,replace = TRUE))
set.seed(10)
table(sample(days,size=23,replace = TRUE))
set.seed(10)
table(sample(days,size=23,replace = TRUE))
set.seed(10)
temp <- table(sample(days,size=23,replace = TRUE))
temp
sum(temp==2)
(sum(temp==2) == 1)
(sum(temp==2) == 1)+0
(sum(temp==2) == 2)+0
(do(10000)*((sum(table(sample(days,size=23,replace = TRUE)) == 2)==2)+0)) %>%
summarise(prob=mean(result))
(do(10000)*length(unique(sample(days,size=23,replace = TRUE)))) %>%
mutate(match=if_else(length==21,1,0)) %>%
summarise(prob=mean(match))
(do(10000)*length(unique(sample(days,size=23,replace = TRUE)))) %>%
mutate(match=if_else(length==21,1,0)) %>%
summarise(prob=mean(match))
choose(23,2)*choose(21,2)*prod(365:345)/365^23
library(mosaic)
?rflip
rflip(2)
names(rflip(2))
rflip
rflip(10)
rflip(10)
knitr::opts_chunk$set(echo = TRUE)
library(prob)
library(mosaic)
rflips(2)
rflip(2)
set.seed(12)
rflip(2)
set.seed(13)
rflip(2)
set.seed(14)
rflip(2)
set.seed(15)
rflip(2)
set.seed(16)
rflip(2)
set.seed(17)
rflip(2)
set.seed(18)
rflip(2)
?intersect
detach("package:prob", unload = TRUE)
library(prob)
S <- cards(makespace = T)
S
class(S)
set.seed(73)
rflip(3)
do(3)*rflip(3)
results <- do(1000)*rflip(3)
head(results)
results %>%
gf_bar(~heads)
results %>%
filter(heads==2) %>%
summarize(prob=n()/1000)
names(heads)
names(results)
class(results)
results %>%
filter(heads==2) %>%
summarize(prob=n()/1000)
data.frame(results) %>%
filter(heads==2) %>%
summarize(prob=n()/1000)
class(data.frame(results))
knitr::opts_chunk$set(echo = TRUE)
library(prob)
library(mosaic)
library(tidyverse)
results %>%
filter(heads==2) %>%
summarize(prob=n()/1000)
data.frame(results) %>%
filter(heads==2) %>%
summarize(prob=n()/1000)
View(results)
results %>%
gf_bar(~heads)
results %>%
filter(heads==2) %>%
summarize(prob=n()/1000)
results <- do(10000)*rflip(3)
head(results)
results %>%
gf_bar(~heads)
library(tidyverse)
results %>%
filter(heads==2) %>%
summarize(prob=n()/1000)
knitr::opts_chunk$set(echo = TRUE)
library(prob)
library(mosaic)
library(tidyverse)
set.seed(18)
rflip(2)
set.seed(73)
rflip(3)
results <- do(10000)*rflip(3)
head(results)
results %>%
gf_bar(~heads)
results %>%
filter(heads==2) %>%
summarize(prob=n()/1000)
library(prob)
## Define the sample space
S <- cards(makespace = T)
## Define event A
A <- subset(S, suit == "Club")
nrow(A) / nrow(S)
Prob(A)
## Define event B
B <- subset(S, rank %in% c(10, "J", "Q", "K", "A"))
Prob(B)
## Determine the union of A and B
unionAB <- union(A, B)
Prob(unionAB)
## Determine the intersect of A and B
intAB <- intersect(A, B)
Prob(intAB)
## Determine the complement of B
Bcomp <- setdiff(S, B)
Prob(Bcomp)
## Find outcomes in B but not in A
BnotA <- setdiff(B, A)
Prob(BnotA)
results %>%
filter(heads==2) %>%
summarize(prob=n()/10000)
write_csv(S,"Cards.csv")
knitr::opts_chunk$set(echo = TRUE)
library(mosaic)
library(tidyverse)
Cards <- read_csv("data/Cards.csv")
Cards <- read_csv("data/Cards.csv")
head(Cards)
1/52
Cards <- read_csv("data/Cards.csv")
inspect(Cards)
Cards %>%
filter(suit == "Club")
Cards %>%
filter(suit == "Club") %>%
select(rank,suit)
?deal
deal(Cards,1)
do(3)*deal(Cards,1)
sample(Cards,1)
results <- do(1000)*sample(Cards,1)
head(results)
length(results)
results
results %>%
filter(suit == "Club") %>%
summarize(prob=n()/1000)
results %>%
filter(suit == "Club") %>%
summarize(prob=n()/10000)
results <- do(10000)*sample(Cards,1)
head(results)
results %>%
filter(suit == "Club") %>%
summarize(prob=n()/10000)
Cards %>%
filter(rank %in% c(10, "J", "Q", "K", "A")) %>%
select(rank,suit)
results %>%
filter(rank %in% c(10, "J", "Q", "K", "A")) %>%
summarize(prob=n()/10000)
20/53
results %>%
mutate(size=n())
results %>%
summarize(size=n())
results %>%
mutate(face=rank %in% c(10, "J", "Q", "K", "A"))
results %>%
mutate(face=rank %in% c(10, "J", "Q", "K", "A"))%>%
summarize(prob=mean(face))
Cards %>%
filter(rank %in% c(10, "J", "Q", "K", "A"),suit=="Club")
Cards %>%
filter(rank %in% c(10, "J", "Q", "K", "A"),suit=="Club") %>%
select(rank,suit)
results %>%
mutate(face=(rank %in% c(10, "J", "Q", "K", "A"))&(suit=="Club"))%>%
summarize(prob=mean(face))
5/52
sample(Cards,5)
do(2)*sample(Cards,5)
sample(Cards,5)$suit
identical(sample(Cards,5)$suit)
all.equal(sample(Cards,5)$suit)
unique(sample(Cards,5)$suit)
knitr::opts_chunk$set(echo = TRUE)
library(mosaic)
library(tidyverse)
num<-choose(13,1)*choose(4,3)*choose(12,1)*choose(4,2)
denom<-choose(52,5)
num/denom
1-364^20/365^20
knitr::opts_chunk$set(echo = TRUE)
library(mosaic)
library(tidyverse)
n<-1:80
prob<-sapply(n, function(x) 1-prod(364^x))/(365^x))
n<-1:80
mybday<-function(x) 1-364^x/365^x
mybday <- Vectorize(mybday)
n<-1:80
mybday<-function(x) 1-364^x/365^x
mybday <- Vectorize(mybday)
mybday(20)
gf_line(mybday(1:80)~ seq(1,80),
xlab="Number of People",
ylab="Probability of Match",
title="Probability of at least 1 person matching my birthday")
gf_line(mybday(n)~ n,
xlab="Number of People",
ylab="Probability of Match",
title="Probability of at least 1 person matching my birthday")
prob <- mybday(1:300)
n<-1:300
n[prob>.5]
prob>.5
mybday(120)
mybday(200)
mybday(150)
n<-1:80
mybday<-function(x) 1-(364/365)^x
mybday <- Vectorize(mybday)
mybday(150)
mybday(200)
prob <- mybday(1:300)
n<-1:300
prob <- mybday(1:300)
n<-1:300
n[prob >= .5][1]
which(prob>=.5)
prob <- mybday(1:300)
n<-1:300
which(prob>= .5)
30*10/(6^5)
?rflips
library(mosaic)
?rflip
1/10000
knitr::opts_chunk$set(echo = TRUE)
library(mosaic)
library(tidyverse)
set.seed(43)
rflip(1000000,0.001)
set.seed(43)
rflip(10000,0.001)
set.seed(43)
rflip(10000,0.001,summarize = TRUE)
set.seed(43)
rflip(100000,0.001,summarize = TRUE)
set.seed(43)
rflip(1000000,0.001,summarize = TRUE)
set.seed(43)
results <- rflip(1000000,0.001,summarize = TRUE)
results
results['tails']
rflip(results['tails'],.001,summarize = TRUE)
rflip(results['tails'],prob=.001,summarize = TRUE)
results['tails']
class(results['tails'])
as.numeric(results['tails'])
rflip(as.numeric(results['tails']),prob=.001,summarize = TRUE)
set.seed(43)
results <- rflip(1000000,0.0001,summarize = TRUE)
results
rflip(as.numeric(results['tails']),prob=.001,summarize = TRUE)
100/(100+959)
.8^3
1/8
.125*.5/(.125*.5+.8^3*.5)
rflip(3)
do(10)*rflip(3)
knitr::opts_chunk$set(echo = TRUE)
library(prob)
set.seed(501)
rflip(1000,summarize = TRUE)
set.seed(501)
results <- rflip(1000000,summarize = TRUE)
results
do(500717)*rflip(3) %>%
filter(heads==3) %>%
summarise(count=n())
(do(500717)*rflip(3)) %>%
filter(heads==3) %>%
summarise(count=n())
set.seed(501)
results <- rflip(100000,summarize = TRUE)
results
(do(50226)*rflip(3)) %>%
filter(heads==3) %>%
summarise(count=n())
do(4)*rflip(3)
(do(4)*rflip(3)) %>%
filter(heads==1)
library(tidyverse)
(do(4)*rflip(3)) %>%
filter(heads==1)
class(do(4)*rflip(3))
names(do(4)*rflip(3))
data.frame(do(4)*rflip(3)) %>%
filter(heads==1)
do(4)*rflip(3) %>%
data.frame() %>%
filter(heads==1)
class(do(4)*rflip(3))
data.frame(do(4)*rflip(3))
class(data.frame(do(4)*rflip(3)))
library(tidyverse)
data.frame(do(4)*rflip(3)) %>%
filter(heads==1)
results <-data.frame(do(4)*rflip(3))
results
results %>%
filter(heads==1)
names(results)
colnames(results)
names(Births)
Births %>%
filter(year == 1969) %>%
gf_point(births~day_of_year)
knitr::opts_chunk$set(echo = TRUE)
library(mosaic)
library(tidyverse)
data.frame(do(4)*rflip(3)) %>%
filter(heads==1)
data.frame(do(50226)*rflip(3)) %>%
filter(heads==3) %>%
summarise(count=n())
set.seed(501)
results <- rflip(100000,summarize = TRUE)
results
data.frame(do(50226)*rflip(3)) %>%
filter(heads==3) %>%
summarise(count=n()) %>%
pull()
data.frame(do(49774)*rflip(3)) %>%
filter(heads==3,prob=.8) %>%
summarise(count=n()) %>%
pull()
data.frame(do(49774)*rflip(3,prob=0.8)) %>%
filter(heads==3) %>%
summarise(count=n()) %>%
pull()
set.seed(501)
results <- rflip(100000,summarize = TRUE)
results
data.frame(do(50226)*rflip(3)) %>%
filter(heads==3) %>%
summarise(count=n()) %>%
pull()
data.frame(do(49774)*rflip(3,prob=0.8)) %>%
filter(heads==3) %>%
summarise(count=n()) %>%
pull()
6270/(6270+25512)
.125*.5/(.125*.5+.8^3*.5)
