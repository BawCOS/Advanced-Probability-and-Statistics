knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(fig.align='center')
knitr::opts_chunk$set(out.width = "75%")
library(infer)
library(knitr)
library(mosaic)
library(tidyverse)
obs<-do(1)*star_mod
obs
do(2)*lm(calories~carb,data=resample(starbucks))
set.seed(401)
obs<-do(1)*star_mod
obs
do(2)*lm(calories~carb,data=resample(starbucks))
set.seed(532)
results <- do(1000)*lm(calories~carb,data=resample(starbucks))
head(results)
results %>%
gf_histogram(~carb) %>%
gf_vline(xintercept = obs$carb,color="red") %>%
gf_theme(theme_classic())
results %>%
gf_histogram(~carb) %>%
gf_vline(xintercept = obs$carb,color="red") %>%
gf_theme(theme_bw())
results %>%
gf_histogram(~carb) %>%
gf_vline(xintercept = obs$carb,color="red") %>%
gf_theme(theme_bw())
cdata(~carb,data=results,p=0.95)
confint(star_mod)
cdata(~r.squared,data=results)
results %>%
gf_histogram(~r.squared) %>%
gf_vline(xintercept = obs$r.squared,color="red") %>%
gf_theme(theme_classic())
starbucks %>%
specify(calories~carb) %>%
generate(reps=10,type="bootstrap") %>%
calculate(stat="slope")
results<- starbucks %>%
specify(calories~carb) %>%
generate(reps=1000,type="bootstrap") %>%
calculate(stat="slope")
head(results)
get_confidence_interval(results)
visualise(results)
star_mod
slope_estimate <- starbucks %>%
specify(calories ~ carb) %>%
calculate(stat="slope")
slope_estimate
(slope_ci<-get_confidence_interval(results))
results %>%
visualze() +
shade_confidence_interval(ci)
results %>%
visualize() +
shade_confidence_interval(ci)
results %>%
visualize() +
shade_confidence_interval(slope_ci)
slope_estimate
(slope_ci<-get_confidence_interval(results,point_estimate = slope_estimate))
(slope_ci<-get_confidence_interval(results))
(slope_ci<-get_confidence_interval(results),point_estimate = slope_estimate)
(slope_ci<-get_confidence_interval(results),point_estimate = slope_estimate))
(slope_ci<-get_confidence_interval(results,point_estimate = slope_estimate))
results %>%
visualize() +
shade_confidence_interval(slope_ci)
results %>%
visualize() +
shade_confidence_interval(slope_ci,color="blue",fill="lightblue")
results %>%
visualize() +
shade_confidence_interval(slope_ci,color="blue",fill="lightblue") +
theme_bw()
results %>%
visualize() +
shade_confidence_interval(slope_ci,color="blue",fill="lightblue") +
geom_vline(xintercept = slope_estimate,color="black")
results %>%
visualize() +
shade_confidence_interval(slope_ci,color="blue",fill="lightblue") +
geom_vline(xintercept = slope_estimate,color="black") +
theme_bw()
slope_estimate
results %>%
visualize() +
shade_confidence_interval(slope_ci,color="blue",fill="lightblue") +
geom_vline(xintercept = slope_estimate$stat,color="black") +
theme_bw()
results %>%
visualize() +
shade_confidence_interval(slope_ci,color="blue",fill="lightblue") +
geom_vline(xintercept = slope_estimate$stat,color="black",size=2) +
theme_bw()
results_resid <- do(10) * lm( calories~carb, data = resample(star_mod)) # resampled residuals
results_resid <- do(10) * lm( calories~carb, data = resample(star_mod)) # resampled residuals
results_resid <- do(10) * lm( calories~carb, data = resample(star_mod)) # resampled residuals
results_resid
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(fig.align='center')
knitr::opts_chunk$set(out.width = "75%")
library(openintro)
library(knitr)
library(mosaic)
library(tidyverse)
set.seed(2003)
x<-runif(50,1,5)
y<-(x-3)^2+rnorm(50,0,0.3)
b0<-lm(y~x)$coefficients[1]
b1<-lm(y~x)$coefficients[2]
plot(x,y)
abline(a=b0,b=b1)
text(2.5,2,paste("y=",round(b0,3),"+",round(b1,3),"* x"))
data(COL)
set.seed(1)
par(mfrow=2:3, mar=rep(0.5, 4))
MyLayOut <- matrix(1:6, 2)
nf <- layout(mat=MyLayOut, widths=c(2,2,2), heights=c(2,1), respect=TRUE)
n <- c(25)
x <- runif(n[1])
y <- -8*x + rnorm(n[1])
plot(x,y, axes=FALSE, pch=20, col=COL[1,2], cex=1.202, xlim=c(-0.03, 1.03), ylim=c(-10, 1))
box()
g <- lm(y~x)
abline(g, col=COL[5])
plot(x, summary(g)$residuals, pch=20, col=COL[1,2], cex=1.202, xlim=c(-0.03, 1.03), axes=FALSE, ylim=2.5*c(-1,1)*max(abs(summary(g)$residuals)))
box()
abline(h=0, col=COL[5], lty=2)
n <- 30
x <- c(runif(n[1]-2, 0, 4), 2, 2.1)
y <- -2*x^2 + rnorm(n[1])
plot(x,y, axes=FALSE, pch=20, col=COL[1,2], cex=1.202, xlim=c(-0.2, 4.2), ylim=c(-35, 2))
box()
g <- lm(y~x)
abline(g, col=COL[5])
plot(x, summary(g)$residuals, pch=20, col=COL[1,2], cex=1.202, xlim=c(-0.2, 4.2), axes=FALSE, ylim=1.8*c(-1,1)*max(abs(summary(g)$residuals)))
box()
abline(h=0, col=COL[5], lty=2)
n <- 40
x <- runif(n[1])
y <- 0.2*x + rnorm(n[1])*x
y[y < -2] <- -1.5
plot(x,y, axes=FALSE, pch=20, col=COL[1,2], cex=1.202, xlim=c(-0.03, 1.03), ylim=c(-2, 2))
box()
g <- lm(y~x)
abline(g, col=COL[5])
plot(x, summary(g)$residuals, pch=20, col=COL[1,2], cex=1.202, xlim=c(-0.03, 1.03), axes=FALSE, ylim=1.2*c(-1,1)*max(abs(summary(g)$residuals)))
box()
abline(h=0, col=COL[5], lty=2)
names(poss_mod)
results_resid <- do(1000) * lm( calories~carb, data = resample(star_mod)) # resampled residuals
head(results_resid)
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(fig.align='center')
knitr::opts_chunk$set(out.width = "75%")
library(infer)
library(knitr)
library(mosaic)
library(tidyverse)
starbucks <- read_csv("data/starbucks.csv")
star_mod <- lm(calories~carb,data=starbucks)
summary(star_mod)
set.seed(401)
obs<-do(1)*star_mod
obs
do(2)*lm(calories~carb,data=resample(starbucks))
set.seed(532)
results <- do(1000)*lm(calories~carb,data=resample(starbucks))
head(results)
results %>%
gf_histogram(~carb) %>%
gf_vline(xintercept = obs$carb,color="red") %>%
gf_theme(theme_bw())
cdata(~carb,data=results,p=0.95)
confint(star_mod)
cdata(~r.squared,data=results)
results %>%
gf_histogram(~r.squared) %>%
gf_vline(xintercept = obs$r.squared,color="red") %>%
gf_theme(theme_classic())
library(infer)
slope_estimate <- starbucks %>%
specify(calories ~ carb) %>%
calculate(stat="slope")
slope_estimate
results<- starbucks %>%
specify(calories~carb) %>%
generate(reps=1000,type="bootstrap") %>%
calculate(stat="slope")
head(results)
(slope_ci<-get_confidence_interval(results,point_estimate = slope_estimate))
results %>%
visualize() +
shade_confidence_interval(slope_ci,color="blue",fill="lightblue") +
geom_vline(xintercept = slope_estimate$stat,color="black",size=2) +
theme_bw()
results_resid <- do(10)*lm( calories~carb, data = resample(star_mod)) # resampled residuals
head(results_resid)
results_resid <- do(1000)*lm( calories~carb, data = resample(star_mod)) # resampled residuals
head(results_resid)
results_resid %>%
gf_histogram(~carb) %>%
gf_vline(xintercept = obs$carb,color="red") %>%
gf_theme(theme_classic())
cdata(~carb,data=results_resid)
predict(star_mod,newdata = data.frame(carb=60),interval="confidence")
head(results)
set.seed(532)
results <- do(1000)*lm(calories~carb,data=resample(starbucks))
results2 <- starbucks %>%
specify(calories~carb) %>%
generate(reps=1000,type="bootstrap") %>%
calculate(stat="slope")
head(results)
(slope_ci<-get_confidence_interval(results2,point_estimate = slope_estimate))
results2 %>%
visualize() +
shade_confidence_interval(slope_ci,color="blue",fill="lightblue") +
geom_vline(xintercept = slope_estimate$stat,color="black",size=2) +
theme_bw()
head(results)
results %>%
mutate(pred=Intercept+carb*60) %>%
cdata(~pred,data=.)
predict(star_mod,newdata = data.frame(carb=60),interval="prediction")
results %>%
mutate(pred=Intercept+carb*60) %>%
cbind(resid=sample(star_mod$residuals,size=1000,replace = TRUE)) %>%
mutate(pred_ind=pred+resid) %>%
cdata(~pred_ind,data=.)
dim(loans_full_schema)
library(openintro)
dim(loans_full_schema)
write_csv(loans_full_schema,"data/loans.csv")
loans <- read_csv("data/loans.csv")
loans <- read_csv("data/loans.csv")
dim(loans)
tally(~homeownership,data=loans,format="proportion")
sum(tally(~homeownership,data=loans,format="proportion"))
tally(~homeownership,data=loans,format="proportion")
loans100 <- loans %>%
select(interest_rate,homeownership) %>%
mutate(homeownership=factor(homeownership)) %>%
group_by(homeownership) %>%
slice_sample(prop=0.01) %>%
ungroup()
tally(~homeownership,data=loans100,format="proportion")
dim(loans100)
set.seed(905)
loans100 <- loans %>%
select(interest_rate,homeownership) %>%
mutate(homeownership=factor(homeownership)) %>%
group_by(homeownership) %>%
slice_sample(prop=0.012) %>%
ungroup()
dim(loans100)
set.seed(905)
loans100 <- loans %>%
select(interest_rate,homeownership) %>%
mutate(homeownership=factor(homeownership)) %>%
group_by(homeownership) %>%
slice_sample(prop=0.011) %>%
ungroup()
dim(loans100)
set.seed(905)
loans100 <- loans %>%
select(interest_rate,homeownership) %>%
mutate(homeownership=factor(homeownership)) %>%
group_by(homeownership) %>%
slice_sample(prop=0.01) %>%
ungroup()
dim(loans100)
tally(~homeownership,data=loans100,format="proportion")
loans100 %>%
gf_boxplot(interest_rate~homeownership) %>%
gf_theme(theme_classic())
loans100 %>%
gf_boxplot(interest_rate~homeownership) %>%
gf_theme(theme_classic()) %>%
gf_labs(title="Lending Club",x="Homeownership",y="Interest Rate")
str(loans100)
loan_mod<-lm(interest_rate ~ homeownership,data=loans100)
summary(loan_mod)
loans100 %>%
filter(homeownership == "MORTGAGE") %>%
summarise(average=mean(interest_rate))
loans100 %>%
group_by(homeownership) %>%
summarise(average=mean(interest_rate),std_dev=sd(interest_rate))
set.seed(532)
results <- do(1000)*lm(calories~carb,data=resample(starbucks))
set.seed(905)
loans100 <- loans %>%
select(interest_rate,homeownership) %>%
mutate(homeownership=factor(homeownership)) %>%
group_by(homeownership) %>%
slice_sample(prop=0.01) %>%
ungroup()
tally(~homeownership,data=loans100,format="proportion")
loans100 %>%
gf_boxplot(interest_rate~homeownership) %>%
gf_theme(theme_classic()) %>%
gf_labs(title="Lending Club",x="Homeownership",y="Interest Rate")
set.seed(532)
results <- do(1000)*lm(interest_rate ~ homeownership,data=resample(loans100))
head(results)
obs<-do(1)*loan_mod
obs
results %>%
gf_histogram(~homeownershipOWN) %>%
gf_vline(xintercept = obs$homeownershipOWN,color="red") %>%
gf_theme(theme_classic())
cdata(~homeownershipOWN,data=results)
confint(loan_mod)
results %>%
mutate(own_rent=homeownershipOWN - homeownershipRENT) %>%
cdata(~own_rent,data=.)
anova(loan_mod)
TukeyHSD(aov(interest_rate~homeownership, data=loans100))
knitr::opts_chunk$set(echo = TRUE)
library(broom)
library(knitr)
library(mosaic)
library(tidyverse)
glimpse(loans)
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(fig.align='center')
knitr::opts_chunk$set(out.width = "75%")
library(broom)
library(knitr)
library(mosaic)
library(tidyverse)
loans <- read_csv("data/loans.csv")
loans <- read_csv("data/loans.csv")
tally(~term,data=loans,format="percent")
set.seed(2111)
loans200 <- loans %>%
select(interest_rate,loan_amount,term) %>%
mutate(term=factor(term)) %>%
group_by(term) %>%
slice_sample(prop=0.02) %>%
ungroup()
tally(~term,data=loans200,format="percent")
str(loans200)
loans200 %>%
ggplot(aes(x="loan_amount",y="interest_rate")) +
geom_point()
ggplot(loans200,aes(x="loan_amount",y="interest_rate")) +
geom_point()
ggplot(loans200,aes(x=loan_amount,y=interest_rate)) +
geom_point()
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(fig.align='center')
knitr::opts_chunk$set(out.width = "75%")
library(infer)
library(knitr)
library(mosaic)
library(tidyverse)
results2 %>%
visualize() +
shade_confidence_interval(slope_ci,color="blue",fill="lightblue") +
geom_vline(xintercept = slope_estimate$stat,color="black",size=2) +
labs(x="Slope") +
theme_bw()
results2 %>%
visualize() +
shade_confidence_interval(slope_ci,color="blue",fill="lightblue") +
geom_vline(xintercept = slope_estimate$stat,color="black",size=2) +
labs(x="Estimated Slope") +
theme_bw()
ggplot(loans200,aes(x=loan_amount,y=interest_rate)) +
geom_point() +
labs(title="Lending Club",subtitle="Loan amount versus Interest rate")
ggplot(loans200,aes(x=loan_amount,y=interest_rate)) +
geom_point() +
labs(title="Lending Club",subtitle="Loan amount versus Interest rate",
x="Loan Amount",y="Interest rate (percent)")
ggplot(loans200,aes(x=loan_amount,y=interest_rate)) +
geom_point() +
labs(title="Lending Club",subtitle="Loan amount versus Interest rate",
x="Loan Amount",y="Interest rate (percent)") +
theme_bw()
int_rate_mod <- lm(interest_rate~loan_amount,data=loans200)
summary(int_rate_mod)
confint(int_rate_mod)
predict(int_rate_mod,newdata = data.frame(loan_amount=20000))
predict(int_rate_mod,newdata = data.frame(loan_amount=20000),interval = "prediction")
predict(int_rate_mod,newdata = data.frame(loan_amount=20000),
interval = "prediction",level=0.90)
plot(int_rate_mod)
results %>%
mutate(pred=Intercept+carb*60) %>%
cbind(resid=sample(star_mod$residuals,size=1000,replace = TRUE)) %>%
mutate(pred_ind=sqrt(pred^2+resid^2)) %>%
cdata(~pred_ind,data=.)
set.seed(532)
results <- do(1000)*lm(calories~carb,data=resample(starbucks))
predict(star_mod,newdata = data.frame(carb=60),interval="prediction")
results %>%
mutate(pred=Intercept+carb*60) %>%
cbind(resid=sample(star_mod$residuals,size=1000,replace = TRUE)) %>%
mutate(pred_ind=sqrt(pred^2+resid^2)) %>%
cdata(~pred_ind,data=.)
results %>%
mutate(pred=Intercept+carb*60) %>%
cbind(resid=sample(star_mod$residuals,size=1000,replace = TRUE)) %>%
mutate(pred_ind=pred+resid) %>%
cdata(~pred_ind,data=.)
results %>%
mutate(pred=Intercept+carb*60) %>%
cbind(resid=sample(star_mod$residuals,size=1000,replace = TRUE)) %>%
mutate(pred_ind=pred+resid) %>%
summariz(mean(pred_ind))
results %>%
mutate(pred=Intercept+carb*60) %>%
cbind(resid=sample(star_mod$residuals,size=1000,replace = TRUE)) %>%
mutate(pred_ind=pred+resid) %>%
summarize(mean(pred_ind))
#  cdata(~pred_ind,data=.)
results %>%
mutate(pred=Intercept+carb*60) %>%
cbind(resid=sample(star_mod$residuals,size=1000,replace = TRUE)) %>%
mutate(pred_ind=pred+resid) %>%
cdata(~pred_ind,data=.)
influence(star_mod)
influence(star_mod)$hat
results %>%
mutate(pred=Intercept+carb*60) %>%
cbind(resid=sample(star_mod$residuals/sqrt(influence(star_mod)$hat),size=1000,replace = TRUE)) %>%
mutate(pred_ind=pred+resid) %>%
cdata(~pred_ind,data=.)
results %>%
mutate(pred=Intercept+carb*60) %>%
cbind(resid=sample(star_mod$residuals/sqrt(1-influence(star_mod)$hat),size=1000,replace = TRUE)) %>%
mutate(pred_ind=pred+resid) %>%
cdata(~pred_ind,data=.)
predict(star_mod,newdata = data.frame(carb=60),interval="prediction")
results %>%
mutate(pred=Intercept+carb*60) %>%
cbind(resid=sample(star_mod$residuals,size=1000,replace = TRUE)) %>%
mutate(pred_ind=pred+resid) %>%
cdata(~pred_ind,data=.)
predict(int_rate_mod,newdata = data.frame(loan_amount=20000),
interval = "confidence",level=0.90)
set.seed(3011)
results <- do(1000)*lm(interest_rate ~ loan_amount,data=resample(loans100))
set.seed(3011)
results <- do(1000)*lm(interest_rate ~ loan_amount,data=resample(loans200))
head(results)
cdata(~loan_amount)
cdata(~loan_amount,data=results)
results2 <- starbucks %>%
specify(calories~carb) %>%
generate(reps=1000,type="bootstrap") %>%
calculate(stat="slope")
head(results2)
(slope_ci<-get_confidence_interval(results2,point_estimate = slope_estimate))
results2 <- loans200 %>%
specify(interest_rate~loan_amount) %>%
generate(reps=1000,type="bootstrap") %>%
calculate(stat="slope")
head(results2)
get_confidence_interval(results2)
results %>%
mutate(pred=Intercept+loan_amount*20000) %>%
cdata(~pred,data=.)
loans %>%
gf_boxplot(interest_rate~term) %>%
gf_theme(theme_classic()) %>%
gf_labs(title="Lending Club",x="Term",y="Interest Rate")
loans200 %>%
gf_boxplot(interest_rate~term) %>%
gf_theme(theme_classic()) %>%
gf_labs(title="Lending Club",x="Term",y="Interest Rate")
loans200 %>%
gf_boxplot(interest_rate~term) %>%
gf_theme(theme_classic()) %>%
gf_labs(title="Lending Club",x="Length of Loan",y="Interest Rate")
loans200 %>%
gf_density(interest_rate~term) %>%
gf_theme(theme_classic()) %>%
gf_labs(title="Lending Club",x="Length of Loan",y="Interest Rate")
loans200 %>%
gf_density(~interest_rate,group=~term) %>%
gf_theme(theme_classic()) %>%
gf_labs(title="Lending Club",x="Length of Loan",y="Interest Rate")
loans200 %>%
gf_dens(~interest_rate,group=~term) %>%
gf_theme(theme_classic()) %>%
gf_labs(title="Lending Club",x="Length of Loan",y="Interest Rate")
loans200 %>%
gf_dens(~interest_rate,group=~term,color=~term) %>%
gf_theme(theme_classic()) %>%
gf_labs(title="Lending Club",x="Length of Loan",y="Interest Rate")
int_rate_mod2 <- lm(interest_rate~term,data=loans200)
summary(int_rate_mod2)
set.seed(331)
results <- do(1000)*lm(interest_rate ~ loan_amount,data=resample(loans200))
head(results)
cdata(~loan_amount,data=results)
set.seed(331)
results <- do(1000)*lm(interest_rate ~ term,data=resample(loans200))
head(results)
cdata(~term,data=results)
cdata(~term60,data=results)
plot(int_rate_mod2)
confint(int_rate_mod2)
mariokart
