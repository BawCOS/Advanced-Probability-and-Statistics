1/mean(rexp(1000,rate=10))
set.seed(630)
1/mean(rexp(1000,rate=10))
do(10)*1/mean(rexp(1000,rate=10))
do(3)*1/mean(rexp(1000,rate=10))
do(3)*(1/mean(rexp(1000,rate=10)))
do(100)*(1/mean(rexp(1000,rate=10)))
(do(100)*(1/mean(rexp(1000,rate=10)))) %>%
gf_boxplot(~result)
(do(1000)*(1/mean(rexp(1000,rate=10)))) %>%
gf_boxplot(~result)
(do(1000)*(1/mean(rexp(10000,rate=10)))) %>%
gf_boxplot(~result)
(do(1000)*(1/mean(rexp(1000,rate=10)))) %>%
gf_boxplot(~result)
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(fig.align='center')
knitr::opts_chunk$set(out.width = "75%")
library(knitr)
library(mosaic)
library(tidyverse)
set.seed(7220)
discrim <- data.frame(gender =c(rep('male', 24), rep('female', 24)), decision = c(rep(c('promoted', 'not_promoted'), c(21, 3)), rep(c('promoted', 'not_promote'), c(14, 10))))
discrim <- discrim %>%
sample() %>%
select(-orig.id)
discrim
write_csv(discrim,"data/discrimination_study.csv")
discrim <- read_csv("data/discrimination_study.csv")
discrim <- read_csv("data/discrimination_study.csv")
inspect(discrim)
tally(genger~decision,discrim)
tally(gender~decision,discrim)
set.seed(7220)
discrim <- data.frame(gender =c(rep('male', 24), rep('female', 24)), decision = c(rep(c('promoted', 'not_promoted'), c(21, 3)), rep(c('promoted', 'not_promoted'), c(14, 10))))
discrim <- discrim %>%
sample() %>%
select(-orig.id)
write_csv(discrim,"data/discrimination_study.csv")
discrim <- read_csv("data/discrimination_study.csv")
inspect(discrim)
tally(gender~decision,discrim)
discrim %>%
mutate_if(is.character,as.factor)
discrim <- discrim %>%
mutate_if(is.character,as.factor)
inspect(discrim)
tally(gender~decision,discrim)
?fct_reorder
discrim <- discrim %>%
mutate_if(is.character,as.factor) %>%
mutate(gender=fct_relevel("male"))
inspect(discrim)
tally(gender~decision,discrim)
discrim <- read_csv("data/discrimination_study.csv")
tally(gender~decision,discrim)
discrim <- discrim %>%
mutate_if(is.character,as.factor) %>%
mutate(gender=fct_relevel(gender,"male"))
inspect(discrim)
tally(gender~decision,discrim)
discrim <- read_csv("data/discrimination_study.csv")
inspect(discrim)
tally(gender~decision,discrim)
discrim <- discrim %>%
mutate_if(is.character,as.factor) %>%
mutate(gender=fct_relevel(gender,"male"),
decision=fct_relevel(decision,"promoted"))
tally(gender~decision,discrim)
?tally
tally(gender~decision,discrim,margins = TRUE)
tally(~gender+decision,discrim,margins = TRUE)
tally(~shuffle(gender)+decision,discrim,margins = TRUE)
set.seed(1011)
tally(~shuffle(gender)+decision,discrim,margins = TRUE)
set.seed(1011)
tally(~shuffle(gender)+decision,discrim,margins = TRUE)
set.seed(101)
tally(~shuffle(gender)+decision,discrim,margins = TRUE)
diffprop(gender~decision,data=discrim)
tally(gender~decision,data=discrim,format="proportion")
.769-.231
.6-.231
diffprop(decision~gender,data=discrim)
diffprop(decision~gender,data=discrim)
?diffprop
tally(decision~gender,data=discrim)
tally(decision~gender,data=discrim,format="proportion")
.875-.583
diffprop(decision~gender,data=discrim)
tally(decision~gender,data=discrim,format="proportion")
diffprop(decision~fct_relevel(gender,"female"),data=discrim)
diffprop(decision~gender,data=discrim)
diffprop(decision~fct_relevel(gender,"female"),data=discrim)
do(5)*diffprop(decision~shuffle(gender),data=discrim)
set.seed(2022)
results <- do(1000)*diffprop(decision~shuffle(gender),data=discrim)
results %>%
gf_density(~diffprop)
results %>%
gf_histogram(~diffprop)
results %>%
gf_histogram(~diffprop) %>%
gf_vline(x=-0.2916667 )
results %>%
gf_histogram(~diffprop) %>%
gf_vline(xintercept = =-0.2916667 )
results %>%
gf_histogram(~diffprop) %>%
gf_vline(xintercept =-0.2916667 )
results %>%
gf_histogram(~diffprop) %>%
gf_vline(xintercept =-0.2916667 )
results %>%
gf_histogram(~diffprop) %>%
gf_vline(xintercept =-0.2916667 )
(obs<-diffprop(decision~gender,data=discrim))
results %>%
summarise(p_value = mean(diffprop<=obs))
knitr::opts_chunk$set(echo = TRUE)
set.seed(7220)
heart <- data.frame(outcome =c(rep('Alive', 28), rep('Dead', 75)), group = c(rep(c('Control', 'Treatment'), c(4, 24)), rep(c('Control', 'Treatment'), c(30, 45))))
heart <- heart %>%
sample() %>%
select(-orig.id)
write_csv(heart,"data/Stanford_heart_study.csv")
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(fig.align='center')
knitr::opts_chunk$set(out.width = "75%")
library(knitr)
library(mosaic)
library(tidyverse)
discrim <- read_csv("data/discrimination_study.csv")
inspect(discrim)
tally(gender~decision,discrim)
discrim <- discrim %>%
mutate_if(is.character,as.factor) %>%
mutate(gender=fct_relevel(gender,"male"),
decision=fct_relevel(decision,"promoted"))
tally(~gender+decision,discrim,margins = TRUE)
set.seed(101)
tally(~shuffle(gender)+decision,discrim,margins = TRUE)
(obs<-diffprop(decision~gender,data=discrim))
diffprop(decision~fct_relevel(gender,"female"),data=discrim)
set.seed(2022)
results <- do(1000)*diffprop(decision~shuffle(gender),data=discrim)
results %>%
gf_histogram(~diffprop) %>%
gf_vline(xintercept =-0.2916667 )
results %>%
summarise(p_value = mean(diffprop<=obs))
knit_with_parameters('~/Classes/Math 377/Advanced Probability and Statistics/18 Hypothesis Testing Case Study Notes.Rmd', encoding = 'UTF-8')
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(fig.align='center')
knitr::opts_chunk$set(out.width = "75%")
library(knitr)
library(mosaic)
library(tidyverse)
heart<-read_csv("data/Stanford_heart_study.csv")
inspect(heart)
tally(outcome~group,data=heart)
tally(outcome~group,data=heart,margins = TRUE)
tally(~outcome+group,data=heart,margins = TRUE)
diffprop(outcome~group,data=heart)
tally(~outcome+group,data=heart,margins = TRUE,format="proportion")
tally(outcome~group,data=heart,margins = TRUE,format="proportion")
30/34
tally(outcome~group,data=heart,margins = TRUE,format="percent")
diffprop(outcome~group,heart)
diffprop(outcome~group,data=heart)
obs<-diffprop(outcome~group,data=heart)
obs
set.seed(1213)
results <- do(1000)*diffprop(outcome~shuffle(group),data=heart)
results %>%
gf_histogram(~diffprop) %>%
gf_vline(xintercept =obs )
results %>%
summarise(p_value = mean(diffprop<=obs))
results %>%
summarise(p_value = mean(diffprop>=obs))
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(fig.align='center')
knitr::opts_chunk$set(out.width = "75%")
library(knitr)
library(mosaic)
library(tidyverse)
ads <- tibble(basic = C(6.95, 10.013, 10.62, 10.15, 8.583,
7.62, 8.233, 10.35, 11.016, 8.516),extended = c(3.383, 7.8, 9.416, 4.66, 5.36,
7.63, 4.95, 8.013, 7.8, 9.58))
ads <- data.frame(basic = C(6.95, 10.013, 10.62, 10.15, 8.583,
7.62, 8.233, 10.35, 11.016, 8.516),extended = c(3.383, 7.8, 9.416, 4.66, 5.36,
7.63, 4.95, 8.013, 7.8, 9.58))
ads <- tibble(basic = c(6.95, 10.013, 10.62, 10.15, 8.583,
7.62, 8.233, 10.35, 11.016, 8.516),extended = c(3.383, 7.8, 9.416, 4.66, 5.36,
7.63, 4.95, 8.013, 7.8, 9.58))
ads <- tibble(basic = c(6.95, 10.013, 10.62, 10.15, 8.583,
7.62, 8.233, 10.35, 11.016, 8.516),extended = c(3.383, 7.8, 9.416, 4.66, 5.36,
7.63, 4.95, 8.013, 7.8, 9.58))
write_csv(ads,"data/ads.csv")
ads <- tibble(basic = c(6.95, 10.013, 10.62, 10.15, 8.583,
7.62, 8.233, 10.35, 11.016, 8.516),premium = c(3.383, 7.8, 9.416, 4.66, 5.36,
7.63, 4.95, 8.013, 7.8, 9.58))
write_csv(ads,"data/ads.csv")
View(ads)
ads<-write_csv("data/ads.csv")
ads<-read_csv("data/ads.csv")
ads<-read_csv("data/ads.csv")
ads<-read_csv("data/ads.csv")
ads
ads
glimpse(ads)
?pivot_longer
vignette("pivot")
pivot_longer(ads,everyting(),names_to="channel",values_to = "length")
pivot_longer(ads,cols=everyting(),names_to="channel",values_to = "length")
pivot_longer(ads,cols=everything(),names_to="channel",values_to = "length")
ads <- ads %>%
pivot_longer(cols=everything(),names_to="channel",values_to = "length")
ads
inspect(ads)
?inspect
?favstats
favstats(~channel,data=ads)
favstats(ads)
favstats(~length,data=ads)
favstats(channel~length,data=ads)
favstats(length~channel,data=ads)
ads %>%
gf_boxplot(channel~length)
ads %>%
gf_boxplot(channel~length) %>%
labs(title="Commericial Length",subtitle = "Random 30 minute shows for 2 channel types",x="Length" )
ads %>%
gf_boxplot(channel~length) %>%
labs(title="Commericial Length",subtitle = "Random 30 minute shows for 2 channel types",xlab="Length" )
ads %>%
gf_boxplot(channel~length) %>%
gf_labs(title="Commericial Length",subtitle = "Random 30 minute shows for 2 channel types",xlab="Length" )
ads %>%
gf_boxplot(channel~length) %>%
gf_labs(title="Commericial Length",subtitle = "Random 30 minute shows for 2 channel types",x="Length" )
ads %>%
gf_boxplot(channel~length) %>%
gf_labs(title="Commericial Length",subtitle = "Random 30 minute shows for 2 channel types",
x="Length",y="Channel Type" )
ads %>%
gf_boxplot(channel~length) %>%
gf_labs(title="Commericial Length",subtitle = "Random 30 minute shows for 2 channel types",
x="Length",y="Channel Type" ) %>%
gf_theme(theme_classic)
ads %>%
gf_dens(channel~length)
ads %>%
gf_density(channel~length)
ads %>%
gf_density(~length,group = ~channel)
ads %>%
gf_density(~length,color = ~channel)
ads %>%
gf_dens(~length,color = ~channel)
ads %>%
gf_dens(~length,color = ~channel)%>%
gf_labs(title="Commericial Length",subtitle = "Random 30 minute shows for 2 channel types",
x="Length",y="Channel Type" ) %>%
gf_theme(theme_classic)
diffprop
prop
median(length~channel,ads)
?median
median(length~channel,data=ads)
diff(median(length~channel,data=ads))
diff
median(length~channel,data=ads)
?ratio
median(length~channel,data=ads) %>%
summarize(stat=basic/premium)
class(median(length~channel,data=ads))
median(length~channel,data=ads) %>%
data.frame()
ads %>%
group_by(channel) %>%
summarize(med=median(length))
ads %>%
group_by(channel) %>%
summarize(med=median(length)) %>%
ungroup()
ads %>%
group_by(channel) %>%
summarize(med=median(length)) %>%
ungroup()
median(length~channel,data=ads)
median(length~channel,data=ads)
median(length~channel,data=ads)[1]/median(length~channel,data=ads)[2]
metric(median(length~channel,data=ads) )
metric <- function(x){
x[1]/x[2]
}
metric(median(length~channel,data=ads) )
metric(median(length~channel,data=ads) )
names(metric(median(length~channel,data=ads) ))
metric <- function(x){
temp<-x[1]/x[2]
names(temp) <- "test_stat"
}
metric(median(length~channel,data=ads) )
metric <- function(x){
temp<-x[1]/x[2]
names(temp) <- "test_stat"
return(temp)
}
metric(median(length~channel,data=ads) )
obs<-metric(median(length~channel,data=ads) )
obs
set.seed(371)
metric(median(length~suffle(channel),data=ads))
set.seed(371)
metric(median(length~shuffle(channel),data=ads))
set.seed(371)
metric(median(length~shuffle(channel),data=ads))
set.seed(371)
metric(median(length~shuffle(channel),data=ads))
results <- do(1000)*metric(median(length~shuffle(channel),data=ads))
results %>%
gf_histogram(~test_stat) %>%
gf_vline(xintercept =-0.2916667 )
results %>%
gf_histogram(~test_stat) %>%
gf_vline(xintercept =obs )
results %>%
summarise(p_value = mean(test_stat<=obs))
results %>%
summarise(p_value = mean(test_stat>=obs))
prop1(~(test_stat>=obs),data=results)
set.seed(7220)
thinner <- data.frame(group =c(rep('control', 50), rep('treatment', 40)), outcome = c(rep(c('survived', 'died'), c(11, 39)), rep(c('survived', 'died'), c(14, 26))))
thinner <- thinner %>%
sample() %>%
select(-orig.id)
write_csv(discrim,"data/blood_thinner.csv")
thinner <- read_csv("data/blood_thinner.csv")
thinner <- read_csv("data/blood_thinner.csv")
tally(group~outcome,thinner)
tally(group~outcome,data=thinner)
thinner
set.seed(7220)
thinner <- data.frame(group =c(rep('control', 50), rep('treatment', 40)), outcome = c(rep(c('survived', 'died'), c(11, 39)), rep(c('survived', 'died'), c(14, 26))))
thinner <- thinner %>%
sample() %>%
select(-orig.id)
write_csv(thinner,"data/blood_thinner.csv")
thinner <- read_csv("data/blood_thinner.csv")
thinner
tally(group~outcome,data=thinner)
tally(group~outcome,data=thinner,margins = TRUE)
tally(~group+outcome,data=thinner,margins = TRUE)
diffprop(outcome~group,data=thinner)
tally(group~outcome,data=thinner,margins = TRUE,format="proportion")
39/65
11/25
tally(outcome~group,data=thinner,margins = TRUE,format="proportion")
obs<-diffprop(outcome~group,data=thinner)
obs
set.seed(655)
results <- do(10000)*diffprop(outcome~shuffle(group),data=thinner)
results %>%
gf_histogram(~diffprop) %>%
gf_vline(xintercept =obs )
results %>%
summarise(p_value = mean(test_stat>=obs))
results %>%
summarise(p_value = mean(diffprop<=obs))
prop1(~(diffprop<=obs),data=results)
results %>%
summarise(p_value = mean(diffprop<=obs))
prop1(~(diffprop<=obs),data=results)
knitr::opts_chunk$set(echo = TRUE)
set.seed(7220)
yawn <- data.frame(group =c(rep('control', 16), rep('treatment', 34)), outcome = c(rep(c('yawn', 'no_yawn'), c(4, 12)), rep(c('yawn', 'no_yawn'), c(10, 24))))
yawn <- yawn %>%
sample() %>%
select(-orig.id)
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(fig.align='center')
knitr::opts_chunk$set(out.width = "75%")
library(knitr)
library(mosaic)
library(tidyverse)
set.seed(7220)
yawn <- data.frame(group =c(rep('control', 16), rep('treatment', 34)), outcome = c(rep(c('yawn', 'no_yawn'), c(4, 12)), rep(c('yawn', 'no_yawn'), c(10, 24))))
yawn <- yawn %>%
sample() %>%
select(-orig.id)
write_csv(yawn,"data/yawn.csv")
yawn <- read_csv("data/yawn.csv")
glimpse(yawn)
inspect(yawn)
ads<-read_csv("data/ads.csv")
ads
ads <- ads %>%
pivot_longer(cols=everything(),names_to="channel",values_to = "length")
ads
favstats(length~channel,data=ads)
diff (mean(length~channel,data=ads) )
obs <- diff (mean(length~channel,data=ads))
obs
obs <- diffmean(mean(length~channel,data=ads))
obs <- diffmean(length~channel,data=ads)
obs
set.seed(4172)
results <- do(10000)*diffmean(length~shuffle(channel),data=ads)
results %>%
gf_histogram(~diffmean) %>%
gf_vline(xintercept =obs )
prop1(~(diffmean<==obs),data=results)
head(results)
prop1(~(diffmean<=obs),data=results)
tally(group~outcome,data=yawn)
tally(group~outcome,data=yawn,margins = TRUE)
tally(group~outcome,data=yawn,margins = TRUE,format="proportion")
tally(outcome~group,data=yawn,margins = TRUE,format="proportion")
tally(outcome~group,data=yawn,margins = TRUE)
tally(outcome~group,data=yawn,margins = TRUE,format="proportion")
diffprop(outcome~group,data=yawn)
set.seed(56)
results<-do(10000)*diffprop(outcome~shuffle(group),data=yawn)
prop1(~(diffprop<=obs),data=results)
head(results)
results %>%
gf_histogram(~diffprop) %>%
gf_vline(xintercept =obs )
obs <- diffprop(outcome~group,data=yawn)
obs
results %>%
gf_histogram(~diffprop) %>%
gf_vline(xintercept =obs )
prop1(~(diffprop<=obs),data=results)
?pbinom
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(fig.align='center')
knitr::opts_chunk$set(out.width = "75%")
library(knitr)
library(mosaic)
library(tidyverse)
pbinom(3,120,prob=0.5)
3/120
2*pbinom(3,120,prob=0.5)
round(rbinom(10, 120, 0.5) / 120, 3)
results <- round(rbinom(10000, 120, 0.5) / 120, 3)
results <- rbinom(10000, 120, 0.5) / 120
?replase
?replace
sample(120,c(0,1),replace = TRUE)
sample(c(0,1),size=120,replace = TRUE)
mean(sample(c(0,1),size=120,replace = TRUE))
set.seed(604)
results<-do(10000)*mean(sample(c(0,1),size=120,replace = TRUE))
head(results)
head(results)
results %>%
gf_histogram(~mean) %>%
gf_vline(xintercept =obs)
obs<-3/120
obs
results %>%
gf_histogram(~mean) %>%
gf_vline(xintercept =obs)
prop1(~(mean<=obs),data=results)
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(fig.align='center')
knitr::opts_chunk$set(out.width = "75%")
library(knitr)
library(mosaic)
library(tidyverse)
2*pbinom(3,120,prob=0.5)
obs<-3/120
obs
results <- rbinom(10000, 120, 0.5) / 120
set.seed(604)
results<-do(10000)*mean(sample(c(0,1),size=120,replace = TRUE))
head(results)
results %>%
gf_histogram(~mean) %>%
gf_vline(xintercept =obs)
prop1(~(mean<=obs),data=results)
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(fig.align='center')
knitr::opts_chunk$set(out.width = "75%")
library(knitr)
library(mosaic)
library(tidyverse)
2*pbinom(3,120,prob=0.5)
obs<-3/120
obs
results <- rbinom(10000, 120, 0.5) / 120
set.seed(604)
results<-do(10000)*mean(sample(c(0,1),size=120,replace = TRUE))
head(results)
results %>%
gf_histogram(~mean) %>%
gf_vline(xintercept =obs)
prop1(~(mean<=obs),data=results)
thinner <- read_csv("data/blood_thinner.csv")
thinner
tally(~group+outcome,data=thinner,margins = TRUE)
head(thinner)
fisher.test(thinner)
table(group~outcome,data=thinner)
fisher.test(tally(~group+outcome,data=thinner))
phyper(11,50,40,25)
2*phyper(11,50,40,25)
0.1283872 * 2
