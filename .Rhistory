favstats(~heights)
confint(t_test(~heights))
##Asymptotically
xbar<-mean(heights)
sd<-sd(heights)
n<-length(heights)
tval<-qt(0.975,n-1)
xbar+c(-1,1)*tval*sd/sqrt(n)
heights <- tibble(height=heights)
head(heights)
heights %>%
summarise(mean=mean(height),stand_dev=sd(height),n=n(),
ci=mean+c(-1,1)*qt(0.975,n-1)*stand_dev/sqrt(n))
set.seed(305)
resample(1:10)
set.seed(2115)
boot_results<-do(1000)*mean(~height,data=resample(heights))
boot_results %>%
gf_histogram(~mean) %>%
gf_vline(xintercept = 68.938)
favstats(~mean,data=boot_results)
cdata(~mean,data=boot_results,p=0.95)
qdata(~mean,data=boot_results,p=c(0.025,0.975))
xbar<-mean(boot_results$mean)
SE<-sd(boot_results$mean)
xbar+c(-1,1)*qt(.975,49)*SE
boot_results %>%
mutate(stat=mean) %>%
summarise(mean=mean(stat),stand_dev=sd(stat),ci=mean+c(-1,1)*qt(0.975,49)*stand_dev)
confint(boot_results, method = c("percentile", "stderr"))
set.seed(427)
boot_results<-do(10000)*median(~height,data=resample(heights))
boot_results %>%
gf_histogram(~median) %>%
gf_vline(xintercept = 67.6)
cdata(~median,data=boot_results,p=0.90)
confint(boot_results, method = c("percentile", "stderr"),level=0.9)
data("HELPrct")
HELP_sub <- HELPrct %>%
select(age,sex)
favstats(age~sex,data=HELP_sub)
HELP_sub %>%
gf_boxplot(age~sex)
HELP_sub %>%
gf_dhistogram(~age|sex)
favstats(age~sex,data=HELP_sub)
obs_stat<-diffmean(age~sex,data=HELP_sub)
obs_stat
set.seed(345)
results <- do(10000)*diffmean(age~shuffle(sex),data=HELP_sub)
favstats(~diffmean,data=results)
results %>%
gf_histogram(~diffmean) %>%
gf_vline(xintercept=obs_stat,color="red") %>%
gf_labs(x="Difference of means",title="Sampling distribution of difference of two means",
subtitle="Null assumes equal means")
2*prop1(~(diffmean <= obs_stat),data=results)
cdata(~(diffmean+obs_stat),data=results)
HELP_sub %>%
gf_qq(~age|sex) %>%
gf_qqline(~age|sex)
favstats(age~sex,data=HELP_sub)
(35.47-36.25)+c(-1,1)*qt(.975,106)*sqrt(7.58^2/107+7.75^2/346)
2*pt(-0.92976,106)
t_test(age~sex,data=HELP_sub)
t_test(age~sex,data=HELP_sub,var.equal=TRUE)
favstats(age ~ sex, data = resample(HELP_sub))
favstats(age ~ sex, data = resample(HELP_sub,groups=sex))
set.seed(2527)
results <- do(1000) * diffmean(age ~ sex, data = resample(HELP_sub, groups = sex))
results %>%
gf_histogram(~diffmean)
cdata( ~ diffmean, p = 0.95, data = results)
favstats(age ~ sex, data = resample(HELP_sub))
favstats(age ~ sex, data = resample(HELP_sub,groups=sex))
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(fig.align='center')
knitr::opts_chunk$set(out.width = "75%")
library(knitr)
library(mosaic)
library(tidyverse)
library(openintro)
textbooks %>%
gf_histogram(~diff) %>%
gf_theme(theme_classic()) %>%
gf_labs(title="Distribution of price differences",x="Price difference between UCLA and Amazon")
results %>%
gf_dhistogram(~mean) %>%
gf_dist("norm",mean=12.76,sd=14/sqrt(72),color="red") %>%
gf_vline(xintercept = obs_stat) %>%
gf_theme(theme_classic())
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(fig.align='center')
knitr::opts_chunk$set(out.width = "75%")
library(knitr)
library(mosaic)
library(tidyverse)
library(openintro)
poker<-read_csv("data/poker.csv")
poker %>%
gf_histogram(~winnings)
favstats(~winnings,data=poker)
mad<-function(x){
xbar<-mean(x)
sum(abs(x-xbar))/length(x)
}
obs<-mad(poker$winnings)
obs
set.seed(1122)
results<-do(1000)*mad(resample(poker$winnings))
results %>%
gf_histogram(~mad)
cdata(~mad,data=results)
HELP_sub <- HELPrct %>%
select(age,sex)
obs <- diffmean(age~sex,data=HELP_sub)
obs
means<-mean(age~sex,data=HELP_sub)
means
means['female']
H_female <- HELP_sub %>%
filter(sex=="female") %>%
mutate(age=age-means['female']+means['male'])
mean(~age,data=H_female)
HELP_sub_new<-HELP_sub %>%
filter(sex=="male") %>%
rbind(H_female)
favstats(age~sex,data=HELP_sub_new)
set.seed(1159)
results<-do(1000)*diffmean(age~sex,data=resample(HELP_sub_new))
results %>%
gf_histogram(~diffmean) %>%
gf_vline(xintercept=obs)
2*prop1(~(diffmean<=obs),data=results)
textbooks<-read_csv("data/textbooks.csv")
head(textbooks)
textbooks %>%
gf_point(ucla_new~amaz_new) %>%
gf_abline(slope=1,intercept = 0,color="darkblue")
textbooks %>%
gf_histogram(~diff) %>%
gf_theme(theme_classic()) %>%
gf_labs(title="Distribution of price differences",x="Price difference between UCLA and Amazon")
qqnormsim(diff,textbooks)
t_test(~diff,textbooks)
t_test(textbooks$ucla_new,textbooks$amaz_new,paired=TRUE)
textbooks %>%
summarise(obs_diff=mean(diff))
obs_stat<- textbooks %>%
summarise(obs_diff=mean(diff)) %>%
pull(obs_diff)
obs_stat
set.seed(843)
results<-do(1000)*mean(~diff,data=resample(textbooks))
results %>%
gf_dhistogram(~mean) %>%
gf_dist("norm",mean=12.76,sd=14/sqrt(72),color="red") %>%
gf_vline(xintercept = obs_stat) %>%
gf_theme(theme_classic())
results %>%
gf_dhistogram(~mean) %>%
gf_dist("norm",mean=12.76,sd=14/sqrt(72),color="red") %>%
gf_vline(xintercept = obs_stat) %>%
gf_theme(theme_classic()) %>%
gf_labs(title="Sampling distribution of the mean of differences in price")
results %>%
gf_dhistogram(~mean) %>%
gf_dist("norm",mean=12.76,sd=14/sqrt(72),color="red") %>%
gf_vline(xintercept = obs_stat) %>%
gf_theme(theme_classic()) %>%
gf_labs(title="Sampling distribution of the mean of differences in price",x="Mean of differences in price")
sample(c(-1,1),size=73,replace = TRUE)
set.seed(406)
results <- do(1000)*mean((~diff*sample(c(-1,1),size=73,replace = TRUE)),data=textbooks)
results %>%
gf_histogram(~mean) %>%
gf_theme(theme_classic())
results %>%
gf_histogram(~mean) %>%
gf_theme(theme_classic()) %>%
gf_labs(title="Randomization sampling distribution of mean of differences in price",
x="Mean of price difference")
mlb_obp %>%
gf_boxplot(obp~position) %>%
gf_labs(x="Position Played",y="On Base Percentage") %>%
gf_theme(theme_bw()) %>%
gf_labs(title="Comparison of OBP for different positions")
gf_dist("f",df1=3,df2=323) %>%
gf_vline(xintercept = 1.994,color="red") %>%
gf_theme(theme_classic())
gf_dist("f",df1=3,df2=323) %>%
gf_vline(xintercept = 1.994,color="red") %>%
gf_theme(theme_classic()) %>%
gf_labs(title="F distribution",x="F value")
results %>%
gf_dhistogram(~result) %>%
gf_dist("f",df1=3,df2=323,color="red") %>%
gf_theme(theme_classic())
f_stat <- function(x){
aov(obp~shuffle(position),data=x) %>%
tidy() %>%
summarize(stat=meansq[1]/meansq[2]) %>%
pull()
}
obs<-aov(obp~position,data=mlb_obp) %>%
tidy() %>%
summarize(stat=meansq[1]/meansq[2]) %>%
pull()
library(broom)
aov(obp~position,data=mlb_obp) %>%
tidy()
aov(obp~position,data=mlb_obp) %>%
tidy() %>%
summarize(stat=meansq[1]/meansq[2])
obs<-aov(obp~position,data=mlb_obp) %>%
tidy() %>%
summarize(stat=meansq[1]/meansq[2]) %>%
pull()
obs
f_stat <- function(x){
aov(obp~shuffle(position),data=x) %>%
tidy() %>%
summarize(stat=meansq[1]/meansq[2]) %>%
pull()
}
f_stat(mlb_obp)
set.seed(5321)
results<-do(1000)*(f_stat(mlb_obp))
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(fig.align='center')
knitr::opts_chunk$set(out.width = "75%")
library(openintro)
library(knitr)
library(mosaic)
library(tidyverse)
tally( substance ~ sex, data = HELPrct,
format="prop", margins = TRUE)
e<-c(19.5,19.5,20.5,20.5)
o<-c(22,17,18,23)
x2<-sum(((o-e)^2)/e)
x2
1-pchisq(x2,1)
coin <- tibble(time = c(rep("Day",40),rep("Night",40)),
result = c(rep(c("Heads","Tails"),c(22,18)),rep(c("Heads","Tails"),c(17,23))))
tally(~time+result,data=coin)
chisq.test(tally(~time+result,data=coin),correct = FALSE)
chisq(~time+result,data=coin)
obs <- chisq(substance~sex,data=HELPrct)
obs
set.seed(2720)
results <- do(1000)*chisq(substance~shuffle(sex),data=HELPrct)
results %>%
gf_dhistogram(~X.squared) %>%
gf_vline(xintercept = obs,color="red") %>%
gf_theme(theme_classic()) %>%
gf_dist("chisq",df=2,color="darkblue") %>%
gf_labs(title="Sampling distribution of Pearson Chi-squared test statistic",
subtitle="For the variables sex and substance in the HELPrct data set",
x="Test statistic")
prop1((~X.squared>=obs),data=results)
chisq.test(tally(substance~sex,data=HELPrct))
mlb_obp <- read_csv("data/mlb_obp.csv")
inspect(mlb_obp)
mlb_obp <- mlb_obp %>%
mutate(position=as.factor(position))
favstats(obp~position,data=mlb_obp)
mlb_obp %>%
gf_boxplot(obp~position) %>%
gf_labs(x="Position Played",y="On Base Percentage") %>%
gf_theme(theme_bw()) %>%
gf_labs(title="Comparison of OBP for different positions")
mlb_obp %>%
gf_qq(~obp|position) %>%
gf_qqline()
summary(aov(obp~position,data=mlb_obp))
pf(1.994,3,323,lower.tail = FALSE)
gf_dist("f",df1=3,df2=323) %>%
gf_vline(xintercept = 1.994,color="red") %>%
gf_theme(theme_classic()) %>%
gf_labs(title="F distribution",x="F value")
library(broom)
aov(obp~position,data=mlb_obp) %>%
tidy()
aov(obp~position,data=mlb_obp) %>%
tidy() %>%
summarize(stat=meansq[1]/meansq[2])
obs<-aov(obp~position,data=mlb_obp) %>%
tidy() %>%
summarize(stat=meansq[1]/meansq[2]) %>%
pull()
obs
f_stat <- function(x){
aov(obp~shuffle(position),data=x) %>%
tidy() %>%
summarize(stat=meansq[1]/meansq[2]) %>%
pull()
}
f_stat(mlb_obp)
set.seed(5321)
results<-do(1000)*(f_stat(mlb_obp))
results %>%
gf_dhistogram(~result) %>%
gf_dist("f",df1=3,df2=323,color="red") %>%
gf_theme(theme_classic())
results %>%
gf_dhistogram(~result) %>%
gf_dist("f",df1=3,df2=323,color="red") %>%
gf_theme(theme_classic()) %>%
gf_labs(title="Randomization test sampling distribution",
x="Test statistic")
results %>%
gf_dhistogram(~result) %>%
gf_dist("f",df1=3,df2=323,color="red") %>%
gf_theme(theme_classic()) %>%
gf_labs(title="Randomization test sampling distribution",
subtitle="F distribution is overlayed in red",
x="Test statistic")
f_stat2 <- function(x){
aov(obp~shuffle(position),data=x) %>%
tidy() %>%
summarize(stat=meansq[1]-meansq[2]) %>%
pull(stat)
}
set.seed(5321)
results<-do(1000)*(f_stat2(mlb_obp))
results %>%
gf_dhistogram(~result) %>%
gf_theme(theme_classic()) %>%
gf_labs(title="Randomization test sampling distribution",
subtitle="Test statistic is the difference in variances",
x="Test statistic")
obs<-aov(obp~position,data=mlb_obp) %>%
tidy() %>%
summarize(stat=meansq[1]-meansq[2]) %>%
pull(stat)
obs
prop1(~(result>=obs),results)
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(fig.align='center')
knitr::opts_chunk$set(out.width = "75%")
library(knitr)
library(mosaic)
library(tidyverse)
f_boot <- function(x){
aov(obp~position,data=resample(x)) %>%
tidy() %>%
summarize(stat=meansq[1]/meansq[2]) %>%
pull()
}
set.seed(541)
results<-do(1000)*f_boot(mlb_obp)
results %>%
gf_histogram(~f_boot) %>%
gf_theme(theme_classic())
results %>%
gf_histogram(~f_boot) %>%
gf_theme(theme_classic()) %>%
gf_labs(title="Bootstrap sampling distribution of F test statistic",
x="Test statistic")
cdata(~f_boot,data=results)
mlb_prob3 <- mlb_obp %>%
filter(position=="IF"|position=="OF") %>%
droplevels()
summary(mlb_prob3)
mlb_prob3 %>%
gf_boxplot(obp~position) %>%
gf_theme(theme_classic())
mlb_prob3 %>%
group_by(position) %>%
summarize(stat=sd(obp))
obs <- mlb_prob3 %>%
summarize(stat=sd(obp[position=="IF"])-sd(obp[position=="OF"])) %>%
pull()
obs
perm_stat <- function(x){
x %>%
mutate(position=shuffle(position)) %>%
summarize(stat=sd(obp[position=="IF"])-sd(obp[position=="OF"])) %>%
pull()
}
set.seed(443)
results<-do(1000)*perm_stat(mlb_prob3)
results %>%
gf_histogram(~perm_stat) %>%
gf_vline(xintercept=obs,color="red")
results %>%
gf_histogram(~perm_stat) %>%
gf_vline(xintercept=obs,color="red") %>%
gf_theme(theme_classic())
results %>%
gf_histogram(~perm_stat) %>%
gf_vline(xintercept=obs,color="red") %>%
gf_theme(theme_classic()) %>%
gf_labs(title="Sampling distribution of difference in variances",
subtitle="Randomization permutation test",
x="Test statistic")
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(fig.align='center')
knitr::opts_chunk$set(out.width = "75%")
library(knitr)
library(mosaic)
library(tidyverse)
qnorm(.975)
pnorm(1.96)-pnorm(-1.96)
curve(dnorm(x),from=-3.5,to=3.5,xaxt="n",xlab="",ylab="f")
polygon(c(-1.5,seq(-1.5,1.5,0.01),1.5),c(0,dnorm(seq(-1.5,1.5,0.01)),0),density=15)
text(-1.55,0.35,expression(paste("Prob=1-",alpha,sep="")))
arrows(-1.5,0.32,-0.8,0.25,length=0.1)
axis(1,at=c(-1.5,1.5),labels=c(expression(paste("-z_",alpha,"/2",sep="")),expression(paste("z_",alpha,"/2",sep=""))))
text(-3,0.08,expression(paste("Prob=",alpha,"/2",sep="")))
arrows(-3,0.06,-2.25,0.02,length=0.1)
text(3,0.08,expression(paste("Prob=",alpha,"/2",sep="")))
arrows(3,0.06,2.25,0.02,length=0.1)
qnorm(1-0.05/2)
qnorm(.975)
temperature <- read_csv("data/temperature.csv")
temperature %>%
favstats(~temperature,data=.) %>%
select(mean,sd,n) %>%
summarise(lower_bound=mean-qt(0.975,129)*sd/sqrt(n),
upper_bound=mean+qt(0.975,129)*sd/sqrt(n))
t_test(~temperature,data=temperature,mu=98.6)
confint(t_test(~temperature,data=temperature,mu=98.6))
temperature %>%
favstats(~temperature,data=.) %>%
select(mean,sd,n) %>%
summarise(upper_bound=mean+qt(0.95,129)*sd/sqrt(n))
confint(t_test(~temperature,data=temperature,alternative="less"))
stent <- read_csv("data/stent_study.csv")
tally(~group+outcome30,data=stent,margins = TRUE)
tally(outcome30~group,data=stent,margins = TRUE,format="proportion")
obs<-diffprop(outcome30~group,data=stent)
obs
obs<-diffprop(outcome30~group,data=stent)
obs
set.seed(2027)
results <- do(10000)*diffprop(outcome30~shuffle(group),data=stent)
results %>%
gf_dhistogram(~diffprop) %>%
gf_vline(xintercept =obs ) %>%
gf_theme(theme_classic())
results %>%
gf_dhistogram(~diffprop) %>%
gf_vline(xintercept =obs ) %>%
gf_theme(theme_classic()) %>%
gf_labs(title="Sampling distribution of randomization test",
x="Difference in proportions")
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(fig.align='center')
knitr::opts_chunk$set(out.width = "75%")
library(knitr)
library(mosaic)
library(tidyverse)
qnorm(.975)
pnorm(1.96)-pnorm(-1.96)
curve(dnorm(x),from=-3.5,to=3.5,xaxt="n",xlab="",ylab="f")
polygon(c(-1.5,seq(-1.5,1.5,0.01),1.5),c(0,dnorm(seq(-1.5,1.5,0.01)),0),density=15)
text(-1.55,0.35,expression(paste("Prob=1-",alpha,sep="")))
arrows(-1.5,0.32,-0.8,0.25,length=0.1)
axis(1,at=c(-1.5,1.5),labels=c(expression(paste("-z_",alpha,"/2",sep="")),expression(paste("z_",alpha,"/2",sep=""))))
text(-3,0.08,expression(paste("Prob=",alpha,"/2",sep="")))
arrows(-3,0.06,-2.25,0.02,length=0.1)
text(3,0.08,expression(paste("Prob=",alpha,"/2",sep="")))
arrows(3,0.06,2.25,0.02,length=0.1)
qnorm(1-0.05/2)
qnorm(.975)
temperature <- read_csv("data/temperature.csv")
temperature %>%
favstats(~temperature,data=.) %>%
select(mean,sd,n) %>%
summarise(lower_bound=mean-qt(0.975,129)*sd/sqrt(n),
upper_bound=mean+qt(0.975,129)*sd/sqrt(n))
t_test(~temperature,data=temperature,mu=98.6)
confint(t_test(~temperature,data=temperature,mu=98.6))
temperature %>%
favstats(~temperature,data=.) %>%
select(mean,sd,n) %>%
summarise(upper_bound=mean+qt(0.95,129)*sd/sqrt(n))
confint(t_test(~temperature,data=temperature,alternative="less"))
stent <- read_csv("data/stent_study.csv")
tally(~group+outcome30,data=stent,margins = TRUE)
tally(outcome30~group,data=stent,margins = TRUE,format="proportion")
obs<-diffprop(outcome30~group,data=stent)
obs
obs<-diffprop(outcome30~group,data=stent)
obs
set.seed(2027)
results <- do(10000)*diffprop(outcome30~shuffle(group),data=stent)
results %>%
gf_dhistogram(~diffprop) %>%
gf_vline(xintercept =obs ) %>%
gf_theme(theme_classic()) %>%
gf_labs(title="Sampling distribution of randomization test",
x="Difference in proportions")
2*prop1(~(diffprop<=obs),data=results)
2*pnorm(-3.16)
results %>%
gf_dhistogram(~diffprop) %>%
gf_vline(xintercept =obs ) %>%
gf_dist("norm",sd=0.0285,color="red") %>%
gf_theme(theme_classic()) %>%
gf_labs(title="Sampling distribution of randomization test",
subtitle="Reference normal distribution in red",
x="Difference in proportions")
results %>%
gf_dhistogram(~diffprop) %>%
gf_vline(xintercept =obs ) %>%
gf_dist("norm",sd=0.0285,color="red") %>%
gf_theme(theme_classic()) %>%
gf_labs(title="Sampling distribution of randomization test",
subtitle="Reference normal distribution in red",
x="Difference in proportions")
