uniroot(function(x)x^2/400+3*x/20-5/4,c(10,30))
uniroot(function(x)x^2/400+3*x/20-5/4-.5,c(10,30))
uniroot(function(x)-x^2/400+3*x/20-5/4-.5,c(10,30))
integrate(function(x)-x/200+3/20,10,15.857)
uniroot(function(x)-x^2/400+3*x/20-5/4-.5,c(10,30))$root
T(.5)
T <- function(y){
uniroot(function(x)-x^2/400+3*x/20-5/4-y,c(10,30))$root
}
T(.5)
integrate(function(x)-x/200+3/20,10,15.857)
T(.5)
T<-Vectorize(T)
T<-Vectorize(T)
T(c(.5,.75))
integrate(function(x)-x/200+3/20,10,20)
T(runif(3))
set.seed(1144)
sim_exercise <- data_frame(T1=T(runif(10000)),T2=T(runif(10000)))
set.seed(1144)
sim_exercise <- tibble(T1=T(runif(10000)),T2=T(runif(10000)))
head(sim_exercise)
inspect(sim_exercise)
gf_histogram(~T1,data=sim_exercise)
gf_dens(~T1,data=sim_exercise)
sim_exercise %>%
mutate(T_sum=T1+T2) %>%
summarise(prob=mean(T_sum<40))
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(fig.pos='ht')
library(knitr)
library(mosaic)
library(tidyverse)
library(cubature)
library(mosaicCalc)
results <- do(10000)*sqrt(runif(1))
inspect(results)
results %>%
gf_density(~sqrt,xlab="X")
y_results <- results %>%
transmute(y=log(sqrt))
y_results %>%
gf_density(~y,xlab="X")
inspect(y_results)
results <- do(100000)*abs(diff(runif(2,5,6)))
results %>%
gf_density(~abs)
results %>%
gf_histogram(~abs)
inspect(results)
data.frame(results) %>%
summarise(mean(abs<=5/60))
z_cdf <- function(x) {
mean(results$abs<=x)
}
z_cdf<- Vectorize(z_cdf)
z_cdf(5/60)
gf_line(z_cdf(seq(0,1,.01))~seq(0,1,.01),xlab="Time Difference",ylab="CDF") %>%
gf_theme(theme_classic())
uniroot(function(x)z_cdf(x)-.5,c(.25,35))$root
y_pdf <- function(x) {
1/(2*sqrt(x))
}
y_pdf<- Vectorize(y_pdf)
integrate(y_pdf,0,1)
gf_line(y_pdf(seq(0,1,.01))~seq(0,1,.01),xlab="Time Difference",ylab="CDF") %>%
gf_theme(theme_classic())
gf_line(y_pdf(seq(0.01,1,.01))~seq(0.01,1,.01),xlab="Time Difference",ylab="CDF") %>%
gf_theme(theme_classic())
y_pdf <- function(y) {
1/(2*sqrt(y))
}
y_pdf<- Vectorize(y_pdf)
integrate(y_pdf,0,1)
set.seed(354)
results <- do(100000)*abs(diff(runif(2,5,6)))
head(results)
data.frame(results) %>%
summarise(mean(abs<=5/60))
z_cdf(5/60)
uniroot(function(x)z_cdf(x)-.5,c(.25,35))$root
0.292*60
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(fig.pos='ht')
library(knitr)
library(mosaic)
library(tidyverse)
library(cubature)
library(mosaicCalc)
integrate(function(x)-x/200+3/20,10,15.857)
gf_dens(~T1,data=sim_exercise) %>%
gf_theme(theme_classic())
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(fig.align='center')
knitr::opts_chunk$set(out.width = "75%")
library(knitr)
library(mosaic)
library(tidyverse)
library(cubature)
library(mosaicCalc)
library(fastR2)
#18 heads, 32 tails, order doesn't matter
x<-c(rep(1,18),rep(0,32))
n<-50
pis<-seq(0.01,0.99,0.01)
lhood<-sapply(pis,function(y) prod(dbinom(x,1,y)))
plot(pis,lhood,type="l",xlab="$\pi$",ylab="Likelihood")
#18 heads, 32 tails, order doesn't matter
x<-c(rep(1,18),rep(0,32))
n<-50
pis<-seq(0.01,0.99,0.01)
lhood<-sapply(pis,function(y) prod(dbinom(x,1,y)))
plot(pis,lhood,type="l",xlab="expression(pi)",ylab="Likelihood")
#18 heads, 32 tails, order doesn't matter
x<-c(rep(1,18),rep(0,32))
n<-50
pis<-seq(0.01,0.99,0.01)
lhood<-sapply(pis,function(y) prod(dbinom(x,1,y)))
plot(pis,lhood,type="l",xlab=expression(pi),ylab="Likelihood")
uniroot(function(x)x^2)
uniroot(function(x)x^2,c(-2,2))
?uniroot
uniroot(function(x)x^2,-2,2)
uniroot(function(x)x^2,lower=-2,upper=2)
uniroot(function(x)x^2,lower=-1,upper=2)
uniroot(function(x)x^2,c(0,2))
uniroot(function(x)x^2,c(-8,2))
uniroot(function(x)x^2,c(-8,+2))
uniroot(function(x) cos(x) - x, lower = -pi, upper = pi)
uniroot(function(x) x^2-4, lower = -pi, upper = pi)
uniroot(function(x) x^2-4, lower = -2, upper = pi)
uniroot(function(x) x^2-4, lower = -2, upper = 2)
uniroot(function(x) x^2-4, lower = -4, upper = 2)
uniroot(function(x) x^2-4, lower = -4, upper = 4)
uniroot(function(x) x^2-4, lower = - 4, upper = 4)
uniroot(function(x) x^2-2, lower = - 4, upper = 4)
uniroot(function(x) x-2, lower = - 4, upper = 4)
uniroot(function(x) 3*x-2, lower = - 4, upper = 4)
uniroot(function(x) 3*x^3-2, lower = - 4, upper = 4)
uniroot(function(x) 3*x^2-2, lower = - 4, upper = 4)
uniroot(function(x) 3*x^2-2, lower = - 10, upper = 10)
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(fig.align='center')
knitr::opts_chunk$set(out.width = "75%")
library(knitr)
library(mosaic)
library(tidyverse)
set.seed(3030)
sort(runif(10,max=5))
set.seed(3030)
temp<-runif(10,max=5)
temp
2*mean(temp)
set.seed(3030)
check(10)
check <- function(n=10){
temp<-runif(n,max=5)
2*mean(temp)<max(temp)
}
set.seed(3030)
check(10)
(do(10000)*check(10)) %>%
summarize(mean(check)) %>%
pull()
check <- Vectorize(check)
my_data<-(do(1000)*check(seq(10,200,5))) %>%
summarise_all(mean) %>%
pivot_longer(everything(),names_to = "Sample",values_to = "Percent") %>%
mutate(Sample=seq(10,200,5))
head(my_data)
my_data %>%
gf_line(Percent~Sample,xlab="Sample Size",title="Percent When Estimator is Valid") %>%
gf_theme(theme = theme_minimal())
my_data %>%
gf_line(Percent~Sample,xlab="Sample Size",title="Percent When Estimator is Invalid") %>%
gf_theme(theme = theme_minimal())
simn<-function(n){
y<-replicate(1000,{
x<-runif(n)
(2*mean(x))<max(x)
})
mean(y)
}
t<-seq(10,200,4)
persim<-sapply(t,simn)
plot(t,persim,type="l")
set.seed(630)
1/mean(rexp(1000,rate=10))
(do(1000)*(1/mean(rexp(1000,rate=10)))) %>%
gf_boxplot(~result)
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(fig.align='center')
knitr::opts_chunk$set(out.width = "75%")
library(knitr)
library(mosaic)
library(tidyverse)
library(cubature)
library(mosaicCalc)
library(fastR2)
include_graphics("figures/Prob_Stats.png")
#18 heads, 32 tails, order doesn't matter
x<-c(rep(1,18),rep(0,32))
n<-50
pis<-seq(0.01,0.99,0.01)
lhood<-sapply(pis,function(y) prod(dbinom(x,1,y)))
plot(pis,lhood,type="l",xlab=expression(pi),ylab="Likelihood")
histogram(~eruptions,data=faithful,breaks=30)
# Define function for pdf of eruptions as a mixture of normals
dmix<-function(x,alpha,mu1,mu2,sigma1,sigma2){
if(alpha < 0) dnorm(x,mu2,sigma2)
if(alpha > 1) dnorm(x,mu1,sigma1)
if(alpha >= 0 && alpha <=1){
alpha*dnorm(x,mu1,sigma1)+(1-alpha)*dnorm(x,mu2,sigma2)
}
}
# Create the log-likelihood function
loglik<-function(theta,x){
alpha=theta[1]
mu1=theta[2]
mu2=theta[3]
sigma1=theta[4]
sigma2=theta[5]
density<-function(x){
if(alpha<0) return (Inf)
if(alpha>1) return (Inf)
if(sigma1<0) return (Inf)
if(sigma2<0) return (Inf)
dmix(x,alpha,mu1,mu2,sigma1,sigma2)
}
sum(log(sapply(x,density)))
}
m<-mean(faithful$eruptions)
s<-sd(faithful$eruptions)
mle<-nlmax(loglik,p=c(0.5,m-1,m+1,s,s),x=faithful$eruptions)$estimate
mle
dmix2<-function(x) dmix(x,mle[1],mle[2],mle[3],mle[4],mle[5])
hist(faithful$eruptions,breaks=40,freq=F,main="",xlab="eruptions")
curve(dmix2,from=1,to=6,add=T)
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(fig.align='center')
knitr::opts_chunk$set(out.width = "75%")
library(knitr)
library(mosaic)
library(tidyverse)
tally(gender~decision,discrim,margins=TRUE)
discrim <- read_csv("data/discrimination_study.csv")
tally(gender~decision,discrim,margins=TRUE)
tally(~gender+decision,discrim,margins=TRUE)
head(discrim)
discrim <- discrim %>%
mutate_if(is.character,as.factor) %>%
mutate(gender=fct_relevel(gender,"male"),
decision=fct_relevel(decision,"promoted"))
head(discrim)
head(discrim)
48!/(24!*24!)
factorial(48)/(factorial(24)*factorial(24))
set.seed(2022)
results <- do(1000)*diffprop(decision~shuffle(gender),data=discrim)
results %>%
gf_histogram(~diffprop) %>%
gf_vline(xintercept =-0.2916667 ) %>%
gf_theme(theme_classic())
set.seed(2022)
results <- do(10000)*diffprop(decision~shuffle(gender),data=discrim)
results %>%
gf_histogram(~diffprop) %>%
gf_vline(xintercept =-0.2916667 ) %>%
gf_theme(theme_classic())
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(fig.align='center')
knitr::opts_chunk$set(out.width = "75%")
library(knitr)
library(mosaic)
library(tidyverse)
heart<-read_csv("data/Stanford_heart_study.csv")
inspect(heart)
tally(~outcome+group,data=heart,margins = TRUE)
tally(outcome~group,data=heart,margins = TRUE,format="percent")
obs<-diffprop(outcome~group,data=heart)
obs
results %>%
gf_histogram(~diffprop) %>%
gf_vline(xintercept =obs )
results %>%
gf_histogram(~diffprop,x="Difference in proportions") %>%
gf_vline(xintercept =obs ) %>%
results %>%
gf_histogram(~diffprop,x="Difference in proportions") %>%
gf_vline(xintercept =obs ) %>%
gf_theme(theme_classic())
results %>%
gf_histogram(~diffprop,xlab="Difference in proportions") %>%
gf_vline(xintercept =obs ) %>%
gf_theme(theme_classic())
results %>%
gf_histogram(~diffprop,xlab="Difference in proportions",ylab="Count",title="Stanford Heart Study") %>%
gf_vline(xintercept =obs ) %>%
gf_theme(theme_classic())
results %>%
gf_histogram(~diffprop,xlab="Difference in proportions",ylab="Count",title="Stanford Heart Study",subtitle="Distribution of difference between control and treatment groups") %>%
gf_vline(xintercept =obs ) %>%
gf_theme(theme_classic())
results %>%
gf_histogram(~diffprop) %>%
gf_vline(xintercept =-0.2916667 ) %>%
gf_theme(theme_classic()) %>%
gf_labs(x="Difference in proportions")
results %>%
gf_histogram(~diffprop) %>%
gf_vline(xintercept =-0.2916667 ) %>%
gf_theme(theme_classic()) %>%
gf_labs(x="Difference in proportions",y="Counts",
title="Genderdiscrimination in hiring permutation test")
results %>%
gf_histogram(~diffprop) %>%
gf_vline(xintercept =-0.2916667 ) %>%
gf_theme(theme_classic()) %>%
gf_labs(x="Difference in proportions",y="Counts",
title="Genderdiscrimination in hiring permutation test",
subtitle="Test statistic is difference in promotion for female and male")
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(fig.align='center')
knitr::opts_chunk$set(out.width = "75%")
library(knitr)
library(mosaic)
library(tidyverse)
include_graphics("figures/L-theta.png")
include_graphics("figures/L_theta.png")
my_rbinom<-function(die){rbinom(1,size=die,prob=0.5)}
my_rbinom(3)
my_rbinom(4)
my_rbinom(4)
my_rbinom(4)
my_rbinom<-Vectorize(my_rbinom)
my_rbinom(c(4,5))
sample(1:6)
sample(1:6,1)
do(1000)*sample(1:6,1)
library(mosaic)
library(tidyverse)
do(10)*sample(1:6,1)
game<-do(10000)*sample(1:6,1)
game["heads"]<-my_rbinom(game$sample)
head(game)
game %>%
summarize(prob=mean(sample==heads))
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(fig.align='center')
knitr::opts_chunk$set(out.width = "75%")
library(knitr)
library(mosaic)
library(tidyverse)
tally(~group+outcome,data=thinner,margins = TRUE)
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(fig.align='center')
knitr::opts_chunk$set(out.width = "75%")
library(knitr)
library(mosaic)
library(tidyverse)
2*pbinom(42,120,prob=0.5)
gf_dist("binom",size=120,prob=.5,xlim=c(50,115)) %>%
gf_vline(xintercept = c(42,78),color="red") %>%
gf_labs(title="Binomial pmf",subtitle="Probability of success is 0.5",y="Probability")
obs<-42/120
obs
results <- rbinom(10000, 120, 0.5) / 120
set.seed(604)
results<-do(10000)*mean(sample(c(0,1),size=120,replace = TRUE))
head(results)
results %>%
gf_histogram(~mean) %>%
gf_vline(xintercept =c(obs,1-obs),color="red")
2*prop1(~(mean<=obs),data=results)
thinner <- read_csv("data/blood_thinner.csv")
head(thinner)
tally(~group+outcome,data=thinner,margins = TRUE)
2*phyper(11,50,40,25)
phyper(11,50,40,25)
phyper(39,50,40,65)
1-phyper(39,50,40,65)
phyper(14,40,50,25)
1-phyper(14,40,50,25)
phyper(26,40,50,65)
phyper(39,65,25,50)
1-phyper(39,65,25,50)
phyper(14,40,50,25)
phyper(14,25,65,40)
1-phyper(13,40,50,25)
1-phyper(13,25,65,40)
2*phyper(11,50,40,25)
1-phyper(13,40,50,25)
2*(1-phyper(13,40,50,25))
2*phyper(26,40,50,65)
2*(1-phyper(38,25,65,40))
2*(1-phyper(38,50,40,65))
set.seed(3311)
diff(range(table(sample(1:4,size=12,replace=TRUE))))
set.seed(3311)
sample(1:4,size=12,replace=TRUE)
set.seed(3311)
table(sample(1:4,size=12,replace=TRUE))
set.seed(3311)
range(table(sample(1:4,size=12,replace=TRUE)))
set.seed(3311)
diff(range(table(sample(1:4,size=12,replace=TRUE))))
set.seed(9697)
results <- do(10000)*sum(abs(table(sample(1:4,size=486,replace=TRUE))-121.5))
results %>%
gf_histogram(~sum) %>%
gf_vline(xintercept = obs,color="red") %>%
gf_labs(title="Sampling Distribution of Absolute Deviations",subtitle="Multinomial with equal probability",
x="Range") %>%
gf_theme(theme_classic)
results %>%
gf_histogram(~sum) %>%
gf_vline(xintercept = obs,color="red") %>%
gf_labs(title="Sampling Distribution of Absolute Deviations",subtitle="Multinomial with equal probability",
x="Absolute deviations") %>%
gf_theme(theme_classic)
obs<-sum(abs(tally(~number,data=golf_balls) -121.5))
obs
results %>%
gf_histogram(~sum) %>%
gf_vline(xintercept = obs,color="red") %>%
gf_labs(title="Sampling Distribution of Absolute Deviations",subtitle="Multinomial with equal probability",
x="Absolute deviations") %>%
gf_theme(theme_classic)
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(fig.align='center')
knitr::opts_chunk$set(out.width = "75%")
library(knitr)
library(mosaic)
library(tidyverse)
yawn <- read_csv("data/yawn.csv")
tally(~outcome+group,data=yawn,margins = TRUE)
phyper(4,16,34,14)
phyper(4,14,36,16)
1-phyper(3,14,36,16)
phyper(4,14,36,16)
phyper(24,36,14,34)
1-phyper(23,36,14,34)
fisher.test(tally(~outcome+group,data=yawn)
phyper(3,16,34,14)
fisher.test(tally(~group+outcome,data=yawn)
fisher.test(tally(~group+outcome,data=yawn))
knitr::opts_chunk$set(echo = TRUE)
1/36(1+2+3+4+5+6+2+2+3+4+5+6+3+3+3+4+5+6+4+4+4+4+5+6+5+5+5+5+5+6+6+6+6+6+6+6)
1/36*(1+2+3+4+5+6+2+2+3+4+5+6+3+3+3+4+5+6+4+4+4+4+5+6+5+5+5+5+5+6+6+6+6+6+6+6)
rbinom(1,10,prob=.6)
rbinom(10,3,prob=.6)
rbinom(3,10,prob=.6)
rbinom(30,10,prob=.6)
pbinom(8,10,prob=.6)
dbinom(8,10,prob=.6)
qbinom(.8,10,prob=.6)
pbinom(7,10,.6)
gf_dist("hyper",m=50,n=40,k=25)
gf_dist("hyper",m=50,n=40,k=25) %>%
gf_hline(yintercept = dhyper(11,50,40,25),color="red") %>%
gf_labs(title="Binomial pmf",subtitle="Probability of success is 0.5",y="Probability")
gf_dist("hyper",m=50,n=40,k=25) %>%
gf_hline(yintercept = dhyper(11,50,40,25),color="red") %>%
gf_labs(title="Hypergeometric pmf",subtitle="Red line is P(X=11)",y="Probability")
dhyper(11:12,50,40,25)
dhyper(0:25,50,40,25)
sum(dhyper(0:25,50,40,25))
temp<-dhyper(0:25,50,40,25)
sum(temp[temp<=dhyper(11,50,40,25)])
fisher.test(tally(~group+outcome,data=thinner))
phyper(4,16,34,14)
gf_dist("hyper",m=16,n=34,k=14) %>%
gf_hline(yintercept = dhyper(4,16,34,14),color="red") %>%
gf_labs(title="Hypergeometric pmf",subtitle="Red line is P(X=4)",y="Probability")
fisher.test(tally(~group+outcome,data=yawn))
temp<-dhyper(0:14,16,34,14)
sum(temp[temp<=dhyper(4,16,34,14)])
gf_dist("hyper",m=16,n=34,k=14) %>%
gf_vline(xintercept =4,color="red" )
gf_dist("hyper",m=16,n=34,k=14) %>%
gf_vline(xintercept =4,color="red" ) %>%
gf_theme(theme_classic())
gf_dist("hyper",m=16,n=34,k=14) %>%
gf_vline(xintercept =4,color="red" ) %>%
gf_theme(theme_classic()) %>%
gf_labs(title="Hypergeometric pmf",subtitle="Red line is P(X=4)",y="Probability")
gf_dist("hyper",m=16,n=34,k=14) %>%
gf_vline(xintercept =4,color="red" ) %>%
gf_theme(theme_classic()) %>%
gf_labs(title="Hypergeometric pmf",subtitle="Red line is X=4",y="Probability")
rbinom(2,1,.65)
rbinom(10,1,.65)
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(fig.align='center')
knitr::opts_chunk$set(out.width = "75%")
library(knitr)
library(mosaic)
library(tidyverse)
binom.test(42,50)
binom.test(42,120)
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(fig.pos='ht')
library(knitr)
library(mosaic)
library(tidyverse)
library(cubature)
library(mosaicCalc)
(1/3-(7/12)^2)
5/12-(7/12)^2
(1/3-(7/12)^2)/sqrt((5/12-(7/12)^2)^2)
-0.007/sqrt(.076^2)
sqrt(2.91/5)
