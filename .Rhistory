head(results)
mean(results$mom==6)
results<-do(1000)*mom(sample(1:6,size=10,replace=TRUE))
mean(results$mom==6)
results<-do(1000)*mom(sample(1:10,size=10,replace=TRUE))
mean(results$mom==10)
results<-do(1000)*mom(sample(1:6,size=2,replace=TRUE))
6/36
mean(results$mom==10)
mean(results$mom==6)
1/6^4
6^4
sample(1:3,2,replace = TRUE)
sample(1:3,2)
1-(7/8)^26
library(tidyverse)
?starbucks
library(openintro)
?starbucks
glimpse(starbucks)
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(fig.align='center')
knitr::opts_chunk$set(out.width = "75%")
library(openintro)
library(knitr)
library(mosaic)
library(tidyverse)
glimpse(starbucks)
starbucks <- read_csv("data/starbucks.csv")
glimpse(starbucks)
starbucks <- read_csv("data/starbucks.csv")  %>%
mutate(item=factor(item),type=factor(type))
starbucks <- read_csv("data/starbucks.csv")  %>%
mutate(item=factor(item),type=factor(type))
glimpse(starbucks)
inspect(starbucks)
inspect(starbucks)
starbucks <- read_csv("data/starbucks.csv")  %>%
mutate(type=factor(type))
glimpse(starbucks)
inspect(starbucks)
starbucks %>%
gf_point(calories~carb) %>%
gf_labs(x="Carbohydrates",y="Calories") %>%
gf_theme(theme_classic())
star_mod <- lm(formula = calories ~ carb, data = starbucks)
summary(star_mod)
library(broom)
star_mod <- lm(formula = calories ~ carb, data = starbucks)
summary(star_mod)
glance(star_mod)
augment(star_mod)
tidy(star_mod)
bac
write_csv(bac,"data/bac.csv")
starbucks
new_carb <- data.frame(carb=c(60,70))
predict(star_mod, newdata = new_carb, interval = 'confidence')
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(fig.align='center')
knitr::opts_chunk$set(out.width = "75%")
library(openintro)
library(knitr)
library(mosaic)
library(tidyverse)
possum<-read_csv("data/possum.csv")
head(possum)
plot(star_mod)
star_mod$residuals
names(star_mod)
augment(star_mod)
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(fig.align='center')
knitr::opts_chunk$set(out.width = "75%")
library(knitr)
library(broom)
library(mosaic)
library(tidyverse)
augment(star_mod) %>%
gf_point(.resid~carb)
augment(star_mod) %>%
gf_point(.resid~carb) %>%
gf_hline(yintercept = 0)
augment(star_mod) %>%
gf_point(.resid~carb) %>%
gf_hline(yintercept = 0) %>%
gf_theme(theme_bw())
augment(star_mod) %>%
gf_point(.resid~carb) %>%
gf_hline(yintercept = 0) %>%
gf_theme(theme_bw()) %>%
gf_labs(title="Residual plot",x="Carbohydrates",y="Residual")
augment(star_mod) %>%
gf_point(.resid~carb) %>%
gf_hline(yintercept = 0) %>%
gf_theme(theme_bw()) %>%
gf_labs(title="Residual plot",x="Carbohydrates",y="Residual")
?augment
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(fig.align='center')
knitr::opts_chunk$set(out.width = "75%")
library(openintro)
library(knitr)
library(mosaic)
library(tidyverse)
bac <- read_csv("data/bac.csv")
bac %>%
gf_point(bac~beers) %>%
gf_labs(x="Number of cans of beer",y="BAC") %>%
gf_theme(theme_classic()) %>%
gf_refine(scale_x_continuous(breaks = c(1,2,3,4,5,6,7,8,9)))
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(fig.align='center')
knitr::opts_chunk$set(out.width = "75%")
library(openintro)
library(knitr)
library(mosaic)
library(tidyverse)
library(broom)
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(fig.align='center')
knitr::opts_chunk$set(out.width = "75%")
library(openintro)
library(knitr)
library(mosaic)
library(tidyverse)
tidy(star_mod)
tidy(star_mod) %>%
filter(term=="carb") %>%
mutate(test_stat=(estimate-0)/std.err)
tidy(star_mod) %>%
filter(term=="carb")
tidy(star_mod) %>%
filter(term=="carb") %>%
mutate(test_stat=(estimate-0)/std.error)
tidy(star_mod) %>%
filter(term=="carb") %>%
mutate(test_stat=(estimate-0)/std.error,p_value=2*pt(test_stat,lower.tail = FALSE))
tidy(star_mod) %>%
filter(term=="carb") %>%
mutate(test_stat=(estimate-0)/std.error,p_value=2*pt(test_stat,df=73,lower.tail = FALSE))
tidy(star_mod) %>%
filter(term=="carb") %>%
summarize(test_stat=(estimate-0)/std.error,p_value=2*pt(test_stat,df=73,lower.tail = FALSE))
predict(star_mod, newdata = new_carb, level=0.9 interval = 'prediction')
predict(star_mod, newdata = new_carb, level=0.9, interval = 'prediction')
new_carb <- data.frame(carb=c(60,70))
predict(star_mod, newdata = new_carb, interval = 'prediction')
augment(star_mod,newdata=new_carb)
glance(star_mod)
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(fig.align='center')
knitr::opts_chunk$set(out.width = "75%")
library(openintro)
library(knitr)
library(mosaic)
library(tidyverse)
confint(bac_mod,level=0.9)
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(fig.align='center')
knitr::opts_chunk$set(out.width = "75%")
library(openintro)
library(knitr)
library(mosaic)
library(tidyverse)
starbucks <- read_csv("data/starbucks.csv")
starbucks <- read_csv("data/starbucks.csv")
star_mod <- lm(calories~carb,data=starbucks)
summary(star_mod)
names(summary(star_mod))
summary(star_mod)$sigma
summary(star_mod)$r.squared
starbucks %>%
summarize(correlation=cor(carb,calories),correlation_squared=correlation^2)
summary(star_mod)$fstatistic
plot(star_mod,which = 1)
plot(star_mod,2)
plot(star_mod,which=3)
plot(star_mod,5)
plot(star_mod,which=3)
plot(star_mod,5)
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(fig.align='center')
knitr::opts_chunk$set(out.width = "75%")
library(openintro)
library(knitr)
library(mosaic)
library(tidyverse)
?shuffle
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(fig.align='center')
knitr::opts_chunk$set(out.width = "75%")
library(infer)
library(knitr)
library(mosaic)
library(tidyverse)
obs<-do(1)*star_mod
obs
do(2)*lm(calories~carb,data=resample(starbucks))
set.seed(401)
obs<-do(1)*star_mod
obs
do(2)*lm(calories~carb,data=resample(starbucks))
set.seed(532)
results <- do(1000)*lm(calories~carb,data=resample(starbucks))
head(results)
results %>%
gf_histogram(~carb) %>%
gf_vline(xintercept = obs$carb,color="red") %>%
gf_theme(theme_classic())
results %>%
gf_histogram(~carb) %>%
gf_vline(xintercept = obs$carb,color="red") %>%
gf_theme(theme_bw())
results %>%
gf_histogram(~carb) %>%
gf_vline(xintercept = obs$carb,color="red") %>%
gf_theme(theme_bw())
cdata(~carb,data=results,p=0.95)
confint(star_mod)
cdata(~r.squared,data=results)
results %>%
gf_histogram(~r.squared) %>%
gf_vline(xintercept = obs$r.squared,color="red") %>%
gf_theme(theme_classic())
starbucks %>%
specify(calories~carb) %>%
generate(reps=10,type="bootstrap") %>%
calculate(stat="slope")
results<- starbucks %>%
specify(calories~carb) %>%
generate(reps=1000,type="bootstrap") %>%
calculate(stat="slope")
head(results)
get_confidence_interval(results)
visualise(results)
star_mod
slope_estimate <- starbucks %>%
specify(calories ~ carb) %>%
calculate(stat="slope")
slope_estimate
(slope_ci<-get_confidence_interval(results))
results %>%
visualze() +
shade_confidence_interval(ci)
results %>%
visualize() +
shade_confidence_interval(ci)
results %>%
visualize() +
shade_confidence_interval(slope_ci)
slope_estimate
(slope_ci<-get_confidence_interval(results,point_estimate = slope_estimate))
(slope_ci<-get_confidence_interval(results))
(slope_ci<-get_confidence_interval(results),point_estimate = slope_estimate)
(slope_ci<-get_confidence_interval(results),point_estimate = slope_estimate))
(slope_ci<-get_confidence_interval(results,point_estimate = slope_estimate))
results %>%
visualize() +
shade_confidence_interval(slope_ci)
results %>%
visualize() +
shade_confidence_interval(slope_ci,color="blue",fill="lightblue")
results %>%
visualize() +
shade_confidence_interval(slope_ci,color="blue",fill="lightblue") +
theme_bw()
results %>%
visualize() +
shade_confidence_interval(slope_ci,color="blue",fill="lightblue") +
geom_vline(xintercept = slope_estimate,color="black")
results %>%
visualize() +
shade_confidence_interval(slope_ci,color="blue",fill="lightblue") +
geom_vline(xintercept = slope_estimate,color="black") +
theme_bw()
slope_estimate
results %>%
visualize() +
shade_confidence_interval(slope_ci,color="blue",fill="lightblue") +
geom_vline(xintercept = slope_estimate$stat,color="black") +
theme_bw()
results %>%
visualize() +
shade_confidence_interval(slope_ci,color="blue",fill="lightblue") +
geom_vline(xintercept = slope_estimate$stat,color="black",size=2) +
theme_bw()
results_resid <- do(10) * lm( calories~carb, data = resample(star_mod)) # resampled residuals
results_resid <- do(10) * lm( calories~carb, data = resample(star_mod)) # resampled residuals
results_resid <- do(10) * lm( calories~carb, data = resample(star_mod)) # resampled residuals
results_resid
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(fig.align='center')
knitr::opts_chunk$set(out.width = "75%")
library(openintro)
library(knitr)
library(mosaic)
library(tidyverse)
set.seed(2003)
x<-runif(50,1,5)
y<-(x-3)^2+rnorm(50,0,0.3)
b0<-lm(y~x)$coefficients[1]
b1<-lm(y~x)$coefficients[2]
plot(x,y)
abline(a=b0,b=b1)
text(2.5,2,paste("y=",round(b0,3),"+",round(b1,3),"* x"))
data(COL)
set.seed(1)
par(mfrow=2:3, mar=rep(0.5, 4))
MyLayOut <- matrix(1:6, 2)
nf <- layout(mat=MyLayOut, widths=c(2,2,2), heights=c(2,1), respect=TRUE)
n <- c(25)
x <- runif(n[1])
y <- -8*x + rnorm(n[1])
plot(x,y, axes=FALSE, pch=20, col=COL[1,2], cex=1.202, xlim=c(-0.03, 1.03), ylim=c(-10, 1))
box()
g <- lm(y~x)
abline(g, col=COL[5])
plot(x, summary(g)$residuals, pch=20, col=COL[1,2], cex=1.202, xlim=c(-0.03, 1.03), axes=FALSE, ylim=2.5*c(-1,1)*max(abs(summary(g)$residuals)))
box()
abline(h=0, col=COL[5], lty=2)
n <- 30
x <- c(runif(n[1]-2, 0, 4), 2, 2.1)
y <- -2*x^2 + rnorm(n[1])
plot(x,y, axes=FALSE, pch=20, col=COL[1,2], cex=1.202, xlim=c(-0.2, 4.2), ylim=c(-35, 2))
box()
g <- lm(y~x)
abline(g, col=COL[5])
plot(x, summary(g)$residuals, pch=20, col=COL[1,2], cex=1.202, xlim=c(-0.2, 4.2), axes=FALSE, ylim=1.8*c(-1,1)*max(abs(summary(g)$residuals)))
box()
abline(h=0, col=COL[5], lty=2)
n <- 40
x <- runif(n[1])
y <- 0.2*x + rnorm(n[1])*x
y[y < -2] <- -1.5
plot(x,y, axes=FALSE, pch=20, col=COL[1,2], cex=1.202, xlim=c(-0.03, 1.03), ylim=c(-2, 2))
box()
g <- lm(y~x)
abline(g, col=COL[5])
plot(x, summary(g)$residuals, pch=20, col=COL[1,2], cex=1.202, xlim=c(-0.03, 1.03), axes=FALSE, ylim=1.2*c(-1,1)*max(abs(summary(g)$residuals)))
box()
abline(h=0, col=COL[5], lty=2)
names(poss_mod)
results_resid <- do(1000) * lm( calories~carb, data = resample(star_mod)) # resampled residuals
head(results_resid)
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(fig.align='center')
knitr::opts_chunk$set(out.width = "75%")
library(infer)
library(knitr)
library(mosaic)
library(tidyverse)
starbucks <- read_csv("data/starbucks.csv")
star_mod <- lm(calories~carb,data=starbucks)
summary(star_mod)
set.seed(401)
obs<-do(1)*star_mod
obs
do(2)*lm(calories~carb,data=resample(starbucks))
set.seed(532)
results <- do(1000)*lm(calories~carb,data=resample(starbucks))
head(results)
results %>%
gf_histogram(~carb) %>%
gf_vline(xintercept = obs$carb,color="red") %>%
gf_theme(theme_bw())
cdata(~carb,data=results,p=0.95)
confint(star_mod)
cdata(~r.squared,data=results)
results %>%
gf_histogram(~r.squared) %>%
gf_vline(xintercept = obs$r.squared,color="red") %>%
gf_theme(theme_classic())
library(infer)
slope_estimate <- starbucks %>%
specify(calories ~ carb) %>%
calculate(stat="slope")
slope_estimate
results<- starbucks %>%
specify(calories~carb) %>%
generate(reps=1000,type="bootstrap") %>%
calculate(stat="slope")
head(results)
(slope_ci<-get_confidence_interval(results,point_estimate = slope_estimate))
results %>%
visualize() +
shade_confidence_interval(slope_ci,color="blue",fill="lightblue") +
geom_vline(xintercept = slope_estimate$stat,color="black",size=2) +
theme_bw()
results_resid <- do(10)*lm( calories~carb, data = resample(star_mod)) # resampled residuals
head(results_resid)
results_resid <- do(1000)*lm( calories~carb, data = resample(star_mod)) # resampled residuals
head(results_resid)
results_resid %>%
gf_histogram(~carb) %>%
gf_vline(xintercept = obs$carb,color="red") %>%
gf_theme(theme_classic())
cdata(~carb,data=results_resid)
predict(star_mod,newdata = data.frame(carb=60),interval="confidence")
head(results)
set.seed(532)
results <- do(1000)*lm(calories~carb,data=resample(starbucks))
results2 <- starbucks %>%
specify(calories~carb) %>%
generate(reps=1000,type="bootstrap") %>%
calculate(stat="slope")
head(results)
(slope_ci<-get_confidence_interval(results2,point_estimate = slope_estimate))
results2 %>%
visualize() +
shade_confidence_interval(slope_ci,color="blue",fill="lightblue") +
geom_vline(xintercept = slope_estimate$stat,color="black",size=2) +
theme_bw()
head(results)
results %>%
mutate(pred=Intercept+carb*60) %>%
cdata(~pred,data=.)
predict(star_mod,newdata = data.frame(carb=60),interval="prediction")
results %>%
mutate(pred=Intercept+carb*60) %>%
cbind(resid=sample(star_mod$residuals,size=1000,replace = TRUE)) %>%
mutate(pred_ind=pred+resid) %>%
cdata(~pred_ind,data=.)
dim(loans_full_schema)
library(openintro)
dim(loans_full_schema)
write_csv(loans_full_schema,"data/loans.csv")
loans <- read_csv("data/loans.csv")
loans <- read_csv("data/loans.csv")
dim(loans)
tally(~homeownership,data=loans,format="proportion")
sum(tally(~homeownership,data=loans,format="proportion"))
tally(~homeownership,data=loans,format="proportion")
loans100 <- loans %>%
select(interest_rate,homeownership) %>%
mutate(homeownership=factor(homeownership)) %>%
group_by(homeownership) %>%
slice_sample(prop=0.01) %>%
ungroup()
tally(~homeownership,data=loans100,format="proportion")
dim(loans100)
set.seed(905)
loans100 <- loans %>%
select(interest_rate,homeownership) %>%
mutate(homeownership=factor(homeownership)) %>%
group_by(homeownership) %>%
slice_sample(prop=0.012) %>%
ungroup()
dim(loans100)
set.seed(905)
loans100 <- loans %>%
select(interest_rate,homeownership) %>%
mutate(homeownership=factor(homeownership)) %>%
group_by(homeownership) %>%
slice_sample(prop=0.011) %>%
ungroup()
dim(loans100)
set.seed(905)
loans100 <- loans %>%
select(interest_rate,homeownership) %>%
mutate(homeownership=factor(homeownership)) %>%
group_by(homeownership) %>%
slice_sample(prop=0.01) %>%
ungroup()
dim(loans100)
tally(~homeownership,data=loans100,format="proportion")
loans100 %>%
gf_boxplot(interest_rate~homeownership) %>%
gf_theme(theme_classic())
loans100 %>%
gf_boxplot(interest_rate~homeownership) %>%
gf_theme(theme_classic()) %>%
gf_labs(title="Lending Club",x="Homeownership",y="Interest Rate")
str(loans100)
loan_mod<-lm(interest_rate ~ homeownership,data=loans100)
summary(loan_mod)
loans100 %>%
filter(homeownership == "MORTGAGE") %>%
summarise(average=mean(interest_rate))
loans100 %>%
group_by(homeownership) %>%
summarise(average=mean(interest_rate),std_dev=sd(interest_rate))
set.seed(532)
results <- do(1000)*lm(calories~carb,data=resample(starbucks))
set.seed(905)
loans100 <- loans %>%
select(interest_rate,homeownership) %>%
mutate(homeownership=factor(homeownership)) %>%
group_by(homeownership) %>%
slice_sample(prop=0.01) %>%
ungroup()
tally(~homeownership,data=loans100,format="proportion")
loans100 %>%
gf_boxplot(interest_rate~homeownership) %>%
gf_theme(theme_classic()) %>%
gf_labs(title="Lending Club",x="Homeownership",y="Interest Rate")
set.seed(532)
results <- do(1000)*lm(interest_rate ~ homeownership,data=resample(loans100))
head(results)
obs<-do(1)*loan_mod
obs
results %>%
gf_histogram(~homeownershipOWN) %>%
gf_vline(xintercept = obs$homeownershipOWN,color="red") %>%
gf_theme(theme_classic())
cdata(~homeownershipOWN,data=results)
confint(loan_mod)
results %>%
mutate(own_rent=homeownershipOWN - homeownershipRENT) %>%
cdata(~own_rent,data=.)
anova(loan_mod)
TukeyHSD(aov(interest_rate~homeownership, data=loans100))
