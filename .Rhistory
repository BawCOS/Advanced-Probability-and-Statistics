results<-do(100)*full_house(sample(1:6,size=5,replace=TRUE))
mean(~full_house,data=results)
set.seed(751)
results<-do(1000)*full_house(sample(1:6,size=5,replace=TRUE))
mean(~full_house,data=results)
set.seed(751)
results<-do(10000)*full_house(sample(1:6,size=5,replace=TRUE))
mean(~full_house,data=results)
knitr::opts_chunk$set(echo = TRUE)
library(mosaic)
library(tidyverse)
x<-seq(-3,3,0.001)
fx<-x^2/18
gf_line(fx~x,ylab="f(x)",title="pdf of X") %>%
gf_theme(theme_classic())
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(fig.pos='ht')
library(knitr)
library(mosaic)
library(tidyverse)
library(cubature)
library(mosaicCalc)
library(cubature) # load the package "cubature"
f <- function(x) { (x[1] * x[2]) } # "x" is vector
adaptIntegrate(f, lowerLimit = c(0, 0), upperLimit = c(1, 2))
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(fig.pos='ht')
library(knitr)
library(mosaic)
library(tidyverse)
library(cubature)
library(mosaicCalc)
set.seed(2011)
my_data<-data.frame(misprints=c(rpois(5000,2),rpois(5000,5)))
head(my_data)
dim(my_data)
library(mosaic)
?rflip
rflip(5,.5)
do(10)*rflip(5,.5)
do(10)*rflip(5,.5)['prop']
(do(10)*rflip(5,.5))['prop']
(do(10)*rflip(5,.5))['prop']==.4
count((do(10)*rflip(5,.5))['prop']==.4)
1-pnorm(400,335,72)
do(10)*rflip(5,.5)
do(10)*rflip(5,.5)[2]
(do(10)*rflip(5,.5))[2]
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(fig.pos='ht')
library(knitr)
library(mosaic)
library(tidyverse)
library(cubature)
library(mosaicCalc)
gf_histogram(~misprints,data=my_data)
gf_histogram(~misprints,data=my_data,breaks=seq(-0.5, 15.5, by=1))
gf_histogram(~misprints,data=my_data,breaks=seq(-0.5, 15.5, by=1)) %>%
gr_theme(theme_classic())
gf_histogram(~misprints,data=my_data,breaks=seq(-0.5, 15.5, by=1)) %>%
gf_theme(theme_classic())
gf_histogram(~misprints,data=my_data,breaks=seq(-0.5, 15.5, by=1)) %>%
gf_theme(theme_classic()) %>%
gf_labs(x="Number of Misprints")
gf_bar(~misprints,data=my_data)
gf_bar(~misprints,data=my_data)%>%
gf_theme(theme_classic()) %>%
gf_labs(x="Number of Misprints")
(0.133+0.086+0.081)/0.4
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(fig.pos='ht')
library(knitr)
library(mosaic)
library(tidyverse)
library(cubature)
library(mosaicCalc)
rbinom(1,3,.75)
rbinom(1,3,.75)
rbinom(1,3,.75)
rbinom(1,3,.75)
rbinom(1,3,.75)
rbinom(1,3,.75)
rbinom(1,3,.75)
rbinom(1,3,.75)
rbinom(1,5,.75)
rbinom(1,5,.75)
rbinom(1,5,.75)
rbinom(1,5,.75)
rbinom(1,5,.75)
set.seed(11)
rbinom(1,5,.75)
rbinom(1,5,.75)
rbinom(1,5,.75)
rbinom(1,5,.75)
set.seed(11)
set.seed(11)
rbinom(1,5,.75)
rbinom(1,5,.75)
rbinom(1,5,.75)
rbinom(1,5,.75)
set.seed(11)
rbinom(1,5,.75)
set.seed(17)
rbinom(1,5,.75)
rbinom(1,5,.75)
knitr::opts_chunk$set(echo = TRUE)
library(cubature) # load the package "cubature"
f <- function(x) { (x[1] + x[2]) } # "x" is vector
adaptIntegrate(f, lowerLimit = c(0, 0), upperLimit = c(1, 1))
adaptIntegrate(f, lowerLimit = c(0, 0.75), upperLimit = c(0.2, 1))
f2 <- function(x) { (4*x[1] + 1)/3 } # "x" is vector
adaptIntegrate(f2, lowerLimit = c(0), upperLimit = c(0.2))
2*.2^2+.2
2*.2^2+.2
0.28/3
?matrix
matrix(c(1,2,3,4),nrow=2)
temp<-matrix(c(1,2,3,4),nrow=2)
temp
sum(temp)
temp/sum(temp)
dataframe(num=crep(0,39),,weather=c(rep("clear,28"),c("Light",11)))
dataframe(num=rep(0,39),weather=c(rep("clear,28"),c("Light",11)))
tibble(num=rep(0,39),weather=c(rep("clear,28"),c("Light",11)))
library(tidyverse)
tibble(num=rep(0,39),weather=c(rep("clear,28"),c("Light",11)))
rep(0,39)
data.frame(num=rep(0,39))
data.frame(num=rep(0,39),weather=c(rep("clear,28"),c("Light",11)))
data.frame(num=rep(0,39),weather=c(rep("clear",28),c("Light",11)))
data.frame(num=rep(0,39),weather=c(rep("clear",28),rep("Light",11)))
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(fig.pos='ht')
library(mosaic)
library(tidyverse)
library(mosaicCalc)
results %>%
gf_density(~sqrt,xlab="X")
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(fig.pos='ht')
library(mosaic)
library(tidyverse)
library(mosaicCalc)
integrate(function(x)2*x,0,1)
library(mosaicCalc)
x<-seq(-0.2,1.2,0.001)
y<-pmin(x^2*(x>0),1)
plot(x,y,type="l",ylab="F(x)",main="cdf of X")
results %>%
gf_density(~sqrt,xlab="X")
sqrt(runif(1))
curve(2*x,from=0,to=1,ylab="f(x)",main="pdf of X")
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(fig.pos='ht')
library(knitr)
library(mosaic)
library(tidyverse)
library(cubature)
library(mosaicCalc)
curve(2-x/200+3/20,from=0,to=40,ylab="f(x)",main="pdf of T")
curve(I(x>10)*2-x/200+3/20,from=0,to=40,ylab="f(x)",main="pdf of T")
curve(2-x/200+3/20,from=10,to=30,ylab="f(x)",main="pdf of T")
curve(-x/200+3/20,from=10,to=30,ylab="f(x)",main="pdf of T")
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(fig.pos='ht')
library(knitr)
library(mosaic)
library(tidyverse)
library(cubature)
library(mosaicCalc)
curve(-x/200+3/20,from=10,to=30,ylab="f(x)",main="pdf of T")
integrate(function(x)-x/200+3/20,10,30)
uniroot(function(x)x^2/400+3*x/200-5/4-.5,c(10,30))
uniroot(function(x)x^2/400+3*x/200-5/4-.5,c(10,30))
integrate(function(x)-x/200+3/20,10,23.62)
uniroot(function(x)x^2/400+3*x/200-5/4,c(10,30))
uniroot(function(x)x^2/400+3*x/20-5/4,c(10,30))
uniroot(function(x)x^2/400+3*x/20-5/4-.5,c(10,30))
uniroot(function(x)-x^2/400+3*x/20-5/4-.5,c(10,30))
integrate(function(x)-x/200+3/20,10,15.857)
uniroot(function(x)-x^2/400+3*x/20-5/4-.5,c(10,30))$root
T(.5)
T <- function(y){
uniroot(function(x)-x^2/400+3*x/20-5/4-y,c(10,30))$root
}
T(.5)
integrate(function(x)-x/200+3/20,10,15.857)
T(.5)
T<-Vectorize(T)
T<-Vectorize(T)
T(c(.5,.75))
integrate(function(x)-x/200+3/20,10,20)
T(runif(3))
set.seed(1144)
sim_exercise <- data_frame(T1=T(runif(10000)),T2=T(runif(10000)))
set.seed(1144)
sim_exercise <- tibble(T1=T(runif(10000)),T2=T(runif(10000)))
head(sim_exercise)
inspect(sim_exercise)
gf_histogram(~T1,data=sim_exercise)
gf_dens(~T1,data=sim_exercise)
sim_exercise %>%
mutate(T_sum=T1+T2) %>%
summarise(prob=mean(T_sum<40))
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(fig.pos='ht')
library(knitr)
library(mosaic)
library(tidyverse)
library(cubature)
library(mosaicCalc)
results <- do(10000)*sqrt(runif(1))
inspect(results)
results %>%
gf_density(~sqrt,xlab="X")
y_results <- results %>%
transmute(y=log(sqrt))
y_results %>%
gf_density(~y,xlab="X")
inspect(y_results)
results <- do(100000)*abs(diff(runif(2,5,6)))
results %>%
gf_density(~abs)
results %>%
gf_histogram(~abs)
inspect(results)
data.frame(results) %>%
summarise(mean(abs<=5/60))
z_cdf <- function(x) {
mean(results$abs<=x)
}
z_cdf<- Vectorize(z_cdf)
z_cdf(5/60)
gf_line(z_cdf(seq(0,1,.01))~seq(0,1,.01),xlab="Time Difference",ylab="CDF") %>%
gf_theme(theme_classic())
uniroot(function(x)z_cdf(x)-.5,c(.25,35))$root
y_pdf <- function(x) {
1/(2*sqrt(x))
}
y_pdf<- Vectorize(y_pdf)
integrate(y_pdf,0,1)
gf_line(y_pdf(seq(0,1,.01))~seq(0,1,.01),xlab="Time Difference",ylab="CDF") %>%
gf_theme(theme_classic())
gf_line(y_pdf(seq(0.01,1,.01))~seq(0.01,1,.01),xlab="Time Difference",ylab="CDF") %>%
gf_theme(theme_classic())
y_pdf <- function(y) {
1/(2*sqrt(y))
}
y_pdf<- Vectorize(y_pdf)
integrate(y_pdf,0,1)
set.seed(354)
results <- do(100000)*abs(diff(runif(2,5,6)))
head(results)
data.frame(results) %>%
summarise(mean(abs<=5/60))
z_cdf(5/60)
uniroot(function(x)z_cdf(x)-.5,c(.25,35))$root
0.292*60
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(fig.pos='ht')
library(knitr)
library(mosaic)
library(tidyverse)
library(cubature)
library(mosaicCalc)
integrate(function(x)-x/200+3/20,10,15.857)
gf_dens(~T1,data=sim_exercise) %>%
gf_theme(theme_classic())
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(fig.align='center')
knitr::opts_chunk$set(out.width = "75%")
library(knitr)
library(mosaic)
library(tidyverse)
library(cubature)
library(mosaicCalc)
library(fastR2)
#18 heads, 32 tails, order doesn't matter
x<-c(rep(1,18),rep(0,32))
n<-50
pis<-seq(0.01,0.99,0.01)
lhood<-sapply(pis,function(y) prod(dbinom(x,1,y)))
plot(pis,lhood,type="l",xlab="$\pi$",ylab="Likelihood")
#18 heads, 32 tails, order doesn't matter
x<-c(rep(1,18),rep(0,32))
n<-50
pis<-seq(0.01,0.99,0.01)
lhood<-sapply(pis,function(y) prod(dbinom(x,1,y)))
plot(pis,lhood,type="l",xlab="expression(pi)",ylab="Likelihood")
#18 heads, 32 tails, order doesn't matter
x<-c(rep(1,18),rep(0,32))
n<-50
pis<-seq(0.01,0.99,0.01)
lhood<-sapply(pis,function(y) prod(dbinom(x,1,y)))
plot(pis,lhood,type="l",xlab=expression(pi),ylab="Likelihood")
uniroot(function(x)x^2)
uniroot(function(x)x^2,c(-2,2))
?uniroot
uniroot(function(x)x^2,-2,2)
uniroot(function(x)x^2,lower=-2,upper=2)
uniroot(function(x)x^2,lower=-1,upper=2)
uniroot(function(x)x^2,c(0,2))
uniroot(function(x)x^2,c(-8,2))
uniroot(function(x)x^2,c(-8,+2))
uniroot(function(x) cos(x) - x, lower = -pi, upper = pi)
uniroot(function(x) x^2-4, lower = -pi, upper = pi)
uniroot(function(x) x^2-4, lower = -2, upper = pi)
uniroot(function(x) x^2-4, lower = -2, upper = 2)
uniroot(function(x) x^2-4, lower = -4, upper = 2)
uniroot(function(x) x^2-4, lower = -4, upper = 4)
uniroot(function(x) x^2-4, lower = - 4, upper = 4)
uniroot(function(x) x^2-2, lower = - 4, upper = 4)
uniroot(function(x) x-2, lower = - 4, upper = 4)
uniroot(function(x) 3*x-2, lower = - 4, upper = 4)
uniroot(function(x) 3*x^3-2, lower = - 4, upper = 4)
uniroot(function(x) 3*x^2-2, lower = - 4, upper = 4)
uniroot(function(x) 3*x^2-2, lower = - 10, upper = 10)
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(fig.align='center')
knitr::opts_chunk$set(out.width = "75%")
library(knitr)
library(mosaic)
library(tidyverse)
set.seed(3030)
sort(runif(10,max=5))
set.seed(3030)
temp<-runif(10,max=5)
temp
2*mean(temp)
set.seed(3030)
check(10)
check <- function(n=10){
temp<-runif(n,max=5)
2*mean(temp)<max(temp)
}
set.seed(3030)
check(10)
(do(10000)*check(10)) %>%
summarize(mean(check)) %>%
pull()
check <- Vectorize(check)
my_data<-(do(1000)*check(seq(10,200,5))) %>%
summarise_all(mean) %>%
pivot_longer(everything(),names_to = "Sample",values_to = "Percent") %>%
mutate(Sample=seq(10,200,5))
head(my_data)
my_data %>%
gf_line(Percent~Sample,xlab="Sample Size",title="Percent When Estimator is Valid") %>%
gf_theme(theme = theme_minimal())
my_data %>%
gf_line(Percent~Sample,xlab="Sample Size",title="Percent When Estimator is Invalid") %>%
gf_theme(theme = theme_minimal())
simn<-function(n){
y<-replicate(1000,{
x<-runif(n)
(2*mean(x))<max(x)
})
mean(y)
}
t<-seq(10,200,4)
persim<-sapply(t,simn)
plot(t,persim,type="l")
set.seed(630)
1/mean(rexp(1000,rate=10))
(do(1000)*(1/mean(rexp(1000,rate=10)))) %>%
gf_boxplot(~result)
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(fig.align='center')
knitr::opts_chunk$set(out.width = "75%")
library(knitr)
library(mosaic)
library(tidyverse)
library(cubature)
library(mosaicCalc)
library(fastR2)
include_graphics("figures/Prob_Stats.png")
#18 heads, 32 tails, order doesn't matter
x<-c(rep(1,18),rep(0,32))
n<-50
pis<-seq(0.01,0.99,0.01)
lhood<-sapply(pis,function(y) prod(dbinom(x,1,y)))
plot(pis,lhood,type="l",xlab=expression(pi),ylab="Likelihood")
histogram(~eruptions,data=faithful,breaks=30)
# Define function for pdf of eruptions as a mixture of normals
dmix<-function(x,alpha,mu1,mu2,sigma1,sigma2){
if(alpha < 0) dnorm(x,mu2,sigma2)
if(alpha > 1) dnorm(x,mu1,sigma1)
if(alpha >= 0 && alpha <=1){
alpha*dnorm(x,mu1,sigma1)+(1-alpha)*dnorm(x,mu2,sigma2)
}
}
# Create the log-likelihood function
loglik<-function(theta,x){
alpha=theta[1]
mu1=theta[2]
mu2=theta[3]
sigma1=theta[4]
sigma2=theta[5]
density<-function(x){
if(alpha<0) return (Inf)
if(alpha>1) return (Inf)
if(sigma1<0) return (Inf)
if(sigma2<0) return (Inf)
dmix(x,alpha,mu1,mu2,sigma1,sigma2)
}
sum(log(sapply(x,density)))
}
m<-mean(faithful$eruptions)
s<-sd(faithful$eruptions)
mle<-nlmax(loglik,p=c(0.5,m-1,m+1,s,s),x=faithful$eruptions)$estimate
mle
dmix2<-function(x) dmix(x,mle[1],mle[2],mle[3],mle[4],mle[5])
hist(faithful$eruptions,breaks=40,freq=F,main="",xlab="eruptions")
curve(dmix2,from=1,to=6,add=T)
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(fig.align='center')
knitr::opts_chunk$set(out.width = "75%")
library(knitr)
library(mosaic)
library(tidyverse)
tally(gender~decision,discrim,margins=TRUE)
discrim <- read_csv("data/discrimination_study.csv")
tally(gender~decision,discrim,margins=TRUE)
tally(~gender+decision,discrim,margins=TRUE)
head(discrim)
discrim <- discrim %>%
mutate_if(is.character,as.factor) %>%
mutate(gender=fct_relevel(gender,"male"),
decision=fct_relevel(decision,"promoted"))
head(discrim)
head(discrim)
48!/(24!*24!)
factorial(48)/(factorial(24)*factorial(24))
set.seed(2022)
results <- do(1000)*diffprop(decision~shuffle(gender),data=discrim)
results %>%
gf_histogram(~diffprop) %>%
gf_vline(xintercept =-0.2916667 ) %>%
gf_theme(theme_classic())
set.seed(2022)
results <- do(10000)*diffprop(decision~shuffle(gender),data=discrim)
results %>%
gf_histogram(~diffprop) %>%
gf_vline(xintercept =-0.2916667 ) %>%
gf_theme(theme_classic())
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(fig.align='center')
knitr::opts_chunk$set(out.width = "75%")
library(knitr)
library(mosaic)
library(tidyverse)
heart<-read_csv("data/Stanford_heart_study.csv")
inspect(heart)
tally(~outcome+group,data=heart,margins = TRUE)
tally(outcome~group,data=heart,margins = TRUE,format="percent")
obs<-diffprop(outcome~group,data=heart)
obs
results %>%
gf_histogram(~diffprop) %>%
gf_vline(xintercept =obs )
results %>%
gf_histogram(~diffprop,x="Difference in proportions") %>%
gf_vline(xintercept =obs ) %>%
results %>%
gf_histogram(~diffprop,x="Difference in proportions") %>%
gf_vline(xintercept =obs ) %>%
gf_theme(theme_classic())
results %>%
gf_histogram(~diffprop,xlab="Difference in proportions") %>%
gf_vline(xintercept =obs ) %>%
gf_theme(theme_classic())
results %>%
gf_histogram(~diffprop,xlab="Difference in proportions",ylab="Count",title="Stanford Heart Study") %>%
gf_vline(xintercept =obs ) %>%
gf_theme(theme_classic())
results %>%
gf_histogram(~diffprop,xlab="Difference in proportions",ylab="Count",title="Stanford Heart Study",subtitle="Distribution of difference between control and treatment groups") %>%
gf_vline(xintercept =obs ) %>%
gf_theme(theme_classic())
results %>%
gf_histogram(~diffprop) %>%
gf_vline(xintercept =-0.2916667 ) %>%
gf_theme(theme_classic()) %>%
gf_labs(x="Difference in proportions")
results %>%
gf_histogram(~diffprop) %>%
gf_vline(xintercept =-0.2916667 ) %>%
gf_theme(theme_classic()) %>%
gf_labs(x="Difference in proportions",y="Counts",
title="Genderdiscrimination in hiring permutation test")
results %>%
gf_histogram(~diffprop) %>%
gf_vline(xintercept =-0.2916667 ) %>%
gf_theme(theme_classic()) %>%
gf_labs(x="Difference in proportions",y="Counts",
title="Genderdiscrimination in hiring permutation test",
subtitle="Test statistic is difference in promotion for female and male")
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(fig.align='center')
knitr::opts_chunk$set(out.width = "75%")
library(knitr)
library(mosaic)
library(tidyverse)
include_graphics("figures/L-theta.png")
include_graphics("figures/L_theta.png")
my_rbinom<-function(die){rbinom(1,size=die,prob=0.5)}
my_rbinom(3)
my_rbinom(4)
my_rbinom(4)
my_rbinom(4)
my_rbinom<-Vectorize(my_rbinom)
my_rbinom(c(4,5))
