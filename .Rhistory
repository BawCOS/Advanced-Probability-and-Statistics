metric <- function(x){
temp<-x[1]/x[2]
names(temp) <- "test_stat"
return(temp)
}
metric(median(length~channel,data=ads) )
obs<-metric(median(length~channel,data=ads) )
obs
set.seed(371)
metric(median(length~suffle(channel),data=ads))
set.seed(371)
metric(median(length~shuffle(channel),data=ads))
set.seed(371)
metric(median(length~shuffle(channel),data=ads))
set.seed(371)
metric(median(length~shuffle(channel),data=ads))
results <- do(1000)*metric(median(length~shuffle(channel),data=ads))
results %>%
gf_histogram(~test_stat) %>%
gf_vline(xintercept =-0.2916667 )
results %>%
gf_histogram(~test_stat) %>%
gf_vline(xintercept =obs )
results %>%
summarise(p_value = mean(test_stat<=obs))
results %>%
summarise(p_value = mean(test_stat>=obs))
prop1(~(test_stat>=obs),data=results)
set.seed(7220)
thinner <- data.frame(group =c(rep('control', 50), rep('treatment', 40)), outcome = c(rep(c('survived', 'died'), c(11, 39)), rep(c('survived', 'died'), c(14, 26))))
thinner <- thinner %>%
sample() %>%
select(-orig.id)
write_csv(discrim,"data/blood_thinner.csv")
thinner <- read_csv("data/blood_thinner.csv")
thinner <- read_csv("data/blood_thinner.csv")
tally(group~outcome,thinner)
tally(group~outcome,data=thinner)
thinner
set.seed(7220)
thinner <- data.frame(group =c(rep('control', 50), rep('treatment', 40)), outcome = c(rep(c('survived', 'died'), c(11, 39)), rep(c('survived', 'died'), c(14, 26))))
thinner <- thinner %>%
sample() %>%
select(-orig.id)
write_csv(thinner,"data/blood_thinner.csv")
thinner <- read_csv("data/blood_thinner.csv")
thinner
tally(group~outcome,data=thinner)
tally(group~outcome,data=thinner,margins = TRUE)
tally(~group+outcome,data=thinner,margins = TRUE)
diffprop(outcome~group,data=thinner)
tally(group~outcome,data=thinner,margins = TRUE,format="proportion")
39/65
11/25
tally(outcome~group,data=thinner,margins = TRUE,format="proportion")
obs<-diffprop(outcome~group,data=thinner)
obs
set.seed(655)
results <- do(10000)*diffprop(outcome~shuffle(group),data=thinner)
results %>%
gf_histogram(~diffprop) %>%
gf_vline(xintercept =obs )
results %>%
summarise(p_value = mean(test_stat>=obs))
results %>%
summarise(p_value = mean(diffprop<=obs))
prop1(~(diffprop<=obs),data=results)
results %>%
summarise(p_value = mean(diffprop<=obs))
prop1(~(diffprop<=obs),data=results)
knitr::opts_chunk$set(echo = TRUE)
set.seed(7220)
yawn <- data.frame(group =c(rep('control', 16), rep('treatment', 34)), outcome = c(rep(c('yawn', 'no_yawn'), c(4, 12)), rep(c('yawn', 'no_yawn'), c(10, 24))))
yawn <- yawn %>%
sample() %>%
select(-orig.id)
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(fig.align='center')
knitr::opts_chunk$set(out.width = "75%")
library(knitr)
library(mosaic)
library(tidyverse)
set.seed(7220)
yawn <- data.frame(group =c(rep('control', 16), rep('treatment', 34)), outcome = c(rep(c('yawn', 'no_yawn'), c(4, 12)), rep(c('yawn', 'no_yawn'), c(10, 24))))
yawn <- yawn %>%
sample() %>%
select(-orig.id)
write_csv(yawn,"data/yawn.csv")
yawn <- read_csv("data/yawn.csv")
glimpse(yawn)
inspect(yawn)
ads<-read_csv("data/ads.csv")
ads
ads <- ads %>%
pivot_longer(cols=everything(),names_to="channel",values_to = "length")
ads
favstats(length~channel,data=ads)
diff (mean(length~channel,data=ads) )
obs <- diff (mean(length~channel,data=ads))
obs
obs <- diffmean(mean(length~channel,data=ads))
obs <- diffmean(length~channel,data=ads)
obs
set.seed(4172)
results <- do(10000)*diffmean(length~shuffle(channel),data=ads)
results %>%
gf_histogram(~diffmean) %>%
gf_vline(xintercept =obs )
prop1(~(diffmean<==obs),data=results)
head(results)
prop1(~(diffmean<=obs),data=results)
tally(group~outcome,data=yawn)
tally(group~outcome,data=yawn,margins = TRUE)
tally(group~outcome,data=yawn,margins = TRUE,format="proportion")
tally(outcome~group,data=yawn,margins = TRUE,format="proportion")
tally(outcome~group,data=yawn,margins = TRUE)
tally(outcome~group,data=yawn,margins = TRUE,format="proportion")
diffprop(outcome~group,data=yawn)
set.seed(56)
results<-do(10000)*diffprop(outcome~shuffle(group),data=yawn)
prop1(~(diffprop<=obs),data=results)
head(results)
results %>%
gf_histogram(~diffprop) %>%
gf_vline(xintercept =obs )
obs <- diffprop(outcome~group,data=yawn)
obs
results %>%
gf_histogram(~diffprop) %>%
gf_vline(xintercept =obs )
prop1(~(diffprop<=obs),data=results)
?pbinom
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(fig.align='center')
knitr::opts_chunk$set(out.width = "75%")
library(knitr)
library(mosaic)
library(tidyverse)
pbinom(3,120,prob=0.5)
3/120
2*pbinom(3,120,prob=0.5)
round(rbinom(10, 120, 0.5) / 120, 3)
results <- round(rbinom(10000, 120, 0.5) / 120, 3)
results <- rbinom(10000, 120, 0.5) / 120
?replase
?replace
sample(120,c(0,1),replace = TRUE)
sample(c(0,1),size=120,replace = TRUE)
mean(sample(c(0,1),size=120,replace = TRUE))
set.seed(604)
results<-do(10000)*mean(sample(c(0,1),size=120,replace = TRUE))
head(results)
head(results)
results %>%
gf_histogram(~mean) %>%
gf_vline(xintercept =obs)
obs<-3/120
obs
results %>%
gf_histogram(~mean) %>%
gf_vline(xintercept =obs)
prop1(~(mean<=obs),data=results)
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(fig.align='center')
knitr::opts_chunk$set(out.width = "75%")
library(knitr)
library(mosaic)
library(tidyverse)
2*pbinom(3,120,prob=0.5)
obs<-3/120
obs
results <- rbinom(10000, 120, 0.5) / 120
set.seed(604)
results<-do(10000)*mean(sample(c(0,1),size=120,replace = TRUE))
head(results)
results %>%
gf_histogram(~mean) %>%
gf_vline(xintercept =obs)
prop1(~(mean<=obs),data=results)
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(fig.align='center')
knitr::opts_chunk$set(out.width = "75%")
library(knitr)
library(mosaic)
library(tidyverse)
2*pbinom(3,120,prob=0.5)
obs<-3/120
obs
results <- rbinom(10000, 120, 0.5) / 120
set.seed(604)
results<-do(10000)*mean(sample(c(0,1),size=120,replace = TRUE))
head(results)
results %>%
gf_histogram(~mean) %>%
gf_vline(xintercept =obs)
prop1(~(mean<=obs),data=results)
thinner <- read_csv("data/blood_thinner.csv")
thinner
tally(~group+outcome,data=thinner,margins = TRUE)
head(thinner)
fisher.test(thinner)
table(group~outcome,data=thinner)
fisher.test(tally(~group+outcome,data=thinner))
phyper(11,50,40,25)
2*phyper(11,50,40,25)
0.1283872 * 2
rep(c(1,2,3,4), c(3,4,5,6)
)
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(fig.align='center')
knitr::opts_chunk$set(out.width = "75%")
library(knitr)
library(mosaic)
library(tidyverse)
golf_balls <- tibble(number=rep(c(1,2,3,4), c(3,4,5,6)))
golf_balls
rep(1:4, c(3,4,5,6))
set.seed(1)
golf_balls <- tibble(number=rep(1:4, c(3,4,5,6)))
golf_balls <- golf_balls %>%
sample() %>%
select(-orig.id)
write_csv(thinner,"data/golf_balls.csv")
golf_balls <- read_csv("data/golf_balls.csv")
golf_balls <- read_csv("data/golf_balls.csv")
inspect(golf_balls)
set.seed(1)
golf_balls <- tibble(number=rep(1:4, c(3,4,5,6)))
golf_balls <- golf_balls %>%
sample() %>%
select(-orig.id)
write_csv(golf_balls,"data/golf_balls.csv")
golf_balls <- read_csv("data/golf_balls.csv")
inspect(golf_balls)
tally(~number,data=golf_balls)
set.seed(1)
golf_balls <- tibble(number=rep(1:4, c(137,138,107,104)))
golf_balls <- golf_balls %>%
sample() %>%
select(-orig.id)
write_csv(golf_balls,"data/golf_balls.csv")
golf_balls <- read_csv("data/golf_balls.csv")
inspect(golf_balls)
tally(~number,data=golf_balls)
800/4
500/4
range(tally(~number,data=golf_balls))
max(tally(~number,data=golf_balls))
?range
range(~(tally(~number,data=golf_balls)))
basic::range(tally(~number,data=golf_balls))
base::range(tally(~number,data=golf_balls))
diff(range(tally(~number,data=golf_balls)))
set.seed(3311)
sample(1:4,size=12,replace=TRUE)
set.seed(3311)
table(sample(1:4,size=12,replace=TRUE))
set.seed(3311)
range(table(sample(1:4,size=12,replace=TRUE)))
set.seed(3311)
diff(range(table(sample(1:4,size=12,replace=TRUE))))
sample(1:4,size=12,replace=TRUE)
table(sample(1:4,size=12,replace=TRUE))
range(table(sample(1:4,size=12,replace=TRUE)))
results <- do(10000)*diff(range(table(sample(1:4,size=120,replace=TRUE))))
obs<-diff(range(tally(~number,data=golf_balls)))
obs
results %>%
gf_histogram(~diff) %>%
gf_vline(xintercept = obs)
set.seed(3311)
diff(range(table(sample(1:4,size=12,replace=TRUE))))
set.seed(3311)
sample(1:4,size=12,replace=TRUE)
set.seed(3311)
table(sample(1:4,size=12,replace=TRUE))
set.seed(3311)
range(table(sample(1:4,size=12,replace=TRUE)))
set.seed(3311)
table(sample(1:4,size=120,replace=TRUE))
results <- do(10000)*diff(range(table(sample(1:4,size=500,replace=TRUE))))
results %>%
gf_histogram(~diff) %>%
gf_vline(xintercept = obs)
results %>%
gf_histogram(~diff) %>%
gf_vline(xintercept = obs) %>%
gf_labs(title="Sampling Distribution of Range",subtitle="Multinomial with equal probability")
results %>%
gf_histogram(~diff) %>%
gf_vline(xintercept = obs) %>%
gf_labs(title="Sampling Distribution of Range",subtitle="Multinomial with equal probability",
x="Range")
results %>%
gf_histogram(~diff) %>%
gf_vline(xintercept = obs) %>%
gf_labs(title="Sampling Distribution of Range",subtitle="Multinomial with equal probability",
x="Range") %>%
gf_theme(theme_classic)
prop1(~(diff>=obs),data=results)
tally(~number,data=golf_balls)
tally(~number,data=golf_balls) -125
dim(golf_balls)
486/4
set.seed(3311)
range(table(sample(1:4,size=12,replace=TRUE)))
results <- do(10000)*diff(range(table(sample(1:4,size=486,replace=TRUE))))
results %>%
gf_histogram(~diff) %>%
gf_vline(xintercept = obs) %>%
gf_labs(title="Sampling Distribution of Range",subtitle="Multinomial with equal probability",
x="Range") %>%
gf_theme(theme_classic)
prop1(~(diff>=obs),data=results)
tally(~number,data=golf_balls) -121.5
sum(tally(~number,data=golf_balls) -121.5)
tally(~number,data=golf_balls) -121.5
abs(tally(~number,data=golf_balls) -121.5)
obs<-sum(abs(tally(~number,data=golf_balls) -121.5))
obs
set.seed(3311)
table(sample(1:4,size=12,replace=TRUE))-121.5
set.seed(3311)
table(sample(1:4,size=486,replace=TRUE))-121.5
set.seed(3311)
abs(table(sample(1:4,size=486,replace=TRUE))-121.5)
set.seed(3311)
sum(abs(table(sample(1:4,size=486,replace=TRUE))-121.5))
set.seed(9697)
results <- do(10000)*sum(abs(table(sample(1:4,size=486,replace=TRUE))-121.5))
results %>%
gf_histogram(~diff) %>%
gf_vline(xintercept = obs) %>%
gf_labs(title="Sampling Distribution of Range",subtitle="Multinomial with equal probability",
x="Range") %>%
gf_theme(theme_classic)
set.seed(9697)
results <- do(10)*sum(abs(table(sample(1:4,size=486,replace=TRUE))-121.5))
results
set.seed(9697)
results <- do(10000)*sum(abs(table(sample(1:4,size=486,replace=TRUE))-121.5))
results %>%
gf_histogram(~sum) %>%
gf_vline(xintercept = obs) %>%
gf_labs(title="Sampling Distribution of Absolute Deviations",subtitle="Multinomial with equal probability",
x="Range") %>%
gf_theme(theme_classic)
prop1(~(sum>=obs),data=results)
install.packages("Lock5Data")
library(Lock5Data)
BodyTemp50
install.packages("UsingR")
library(normtemp)
library(UsingR)
normtemp
write_csv(normtemp,"data/temp.csv")
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(fig.align='center')
knitr::opts_chunk$set(out.width = "75%")
library(knitr)
library(mosaic)
library(tidyverse)
yawn <- read_csv("data/yawn.csv")
glimpse(yawn)
inspect(yawn)
tally(~outcome+group,data=yawn,margins = TRUE)
phyper(4,16,34,14)
gf_dist
gf_dist()
?gf_dist
gf_dist("hyper",16,34,14)
gf_dist("hyper",m=16,n=34,k=14)
gf_dist("hyper",m=16,n=34,k=14) %>%
gf_vline(xintercept =4 )
gf_dist("hyper",m=16,n=34,k=14) %>%
gf_vline(xintercept =4,color="red" )
golf_balls <- read_csv("data/golf_balls.csv")
inspect(golf_balls)
tally(~number,data=golf_balls)
tally(~number,data=golf_balls,format = "proportions")
tally(~number,data=golf_balls,format = "proportion")
mean(tally(~number,data=golf_balls,format = "proportion"))
486/4
tally(~number,data=golf_balls,format = "proportion") -121.5
tally(~number,data=golf_balls) -121.5
abs(tally(~number,data=golf_balls) -121.5)
max(abs(tally(~number,data=golf_balls) -121.5))
obs <- max(abs(tally(~number,data=golf_balls) -121.5))
obs <- max(abs(tally(~number,data=golf_balls) -121.5))
obs
set.seed(2517)
results <- do(10)*max(abs(table(sample(1:4,size=486,replace=TRUE))))
results
set.seed(2517)
results <- do(10)*max(abs(table(sample(1:4,size=486,replace=TRUE))-121.5))
results
results %>%
gf_histogram(~max) %>%
gf_vline(xintercept = obs) %>%
gf_labs(title="Sampling Distribution of Maximum Deviation",subtitle="Multinomial with equal probability",
x="Range") %>%
gf_theme(theme_classic)
set.seed(2517)
results <- do(10000)*max(abs(table(sample(1:4,size=486,replace=TRUE))-121.5))
results %>%
gf_histogram(~max) %>%
gf_vline(xintercept = obs) %>%
gf_labs(title="Sampling Distribution of Maximum Deviation",subtitle="Multinomial with equal probability",
x="Range") %>%
gf_theme(theme_classic)
prop1(~(max>=obs),data=results)
temperature <- read_csv("data/temperature.csv")
temperature <- read_csv("data/temperature.csv")
glimpse(temperature)
favstats(~temperature,data=temperature)
temperature %>%
gf_boxplot(~temperature)
temperature %>%
gf_boxplot(~temperature) %>%
gf_theme(theme_classic)
temperature %>%
mutate(pos= (temperature-98.6)>0) %>%
select(pos)
temperature %>%
mutate(pos= (temperature-98.6)>0)
temperature %>%
mutate(pos= (temperature-98.6)>0) %>%
select(pos)
temperature %>%
mutate(pos=(temperature-98.6)>0) %>%
select(pos)
temperature %>%
mutate(pos=(temperature-98.6)>0)
temperature %>%
mutate(pos=(temperature-98.6)>0) %>%
select(gender)
temperature %>%
#  mutate(pos=(temperature-98.6)>0) %>%
select(gender)
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(fig.align='center')
knitr::opts_chunk$set(out.width = "75%")
library(knitr)
library(mosaic)
library(tidyverse)
yawn <- read_csv("data/yawn.csv")
glimpse(yawn)
inspect(yawn)
tally(~outcome+group,data=yawn,margins = TRUE)
phyper(4,16,34,14)
gf_dist("hyper",m=16,n=34,k=14) %>%
gf_vline(xintercept =4,color="red" )
golf_balls <- read_csv("data/golf_balls.csv")
inspect(golf_balls)
tally(~number,data=golf_balls,format = "proportion")
obs <- max(abs(tally(~number,data=golf_balls) -121.5))
obs
set.seed(2517)
results <- do(10000)*max(abs(table(sample(1:4,size=486,replace=TRUE))-121.5))
results %>%
gf_histogram(~max) %>%
gf_vline(xintercept = obs) %>%
gf_labs(title="Sampling Distribution of Maximum Deviation",subtitle="Multinomial with equal probability",
x="Range") %>%
gf_theme(theme_classic)
prop1(~(max>=obs),data=results)
temperature <- read_csv("data/temperature.csv")
glimpse(temperature)
favstats(~temperature,data=temperature)
temperature %>%
gf_boxplot(~temperature) %>%
gf_theme(theme_classic)
temperature %>%
#  mutate(pos=(temperature-98.6)>0) %>%
select(gender)
temperature %>%
mutate(pos=(temperature-98.6)>0) %>%
select(gender)
temperature %>%
mutate(pos=(temperature-98.6)>0) %>%
select(pos)
temperature %>%
mutate(pos=(temperature-98.6)<0) %>%
summarise(num_less=sum(pos))
pbinom(81,130,.5)
1-pbinom(81,130,.5)
temperature %>%
mutate(pos=(temperature-98.6)==0) %>%
summarise(num_less=sum(pos))
temperature %>%
mutate(pos=(temperature-98.6)<0) %>%
summarise(num_less=sum(pos))
temperature %>%
mutate(pos=(temperature-98.6)>0) %>%
summarise(num_less=sum(pos))
81+39
temperature %>%
count(temperature==98.6
temperature %>%
count(temperature==98.6)
temperature %>%
mutate(pos=(temperature-98.6)>0) %>%
summarise(num_less=sum(pos))
130-44
1-pbinom(86,130,.5)
pbinom(44,130,.5)
pbinom(43,130,.5)
?ttest
?t_test
t_test(~temperature,data=temperature)
t_test(~temperature,data=temperature,mu=98.6)
t_test(~temperature,data=temperature,mu=98.6,alternative="less")
