---
title: "Lesson 36 Application Solutions"
author: "Lt Col Ken Horton"
date: "November 20, 2019"
header-includes: 
  - \usepackage{amsmath,multirow}
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(fig.align='center')
knitr::opts_chunk$set(out.width = "75%")
```


\newcommand{\E}{\mbox{E}}
\newcommand{\Var}{\mbox{Var}}
\newcommand{\Cov}{\mbox{Cov}}
\newcommand{\Prob}{\mbox{P}}
\newcommand*\diff{\mathop{}\!\mathrm{d}}

# Exercises

\indent 1. The `mtcars` dataset contains average mileage (mpg) and other information about specific makes and models of cars. (This dataset is built-in to `R`; for more information about this dataset, reference the documentation with `?mtcars`). 

a) Build and interpret the coefficients of a model fitting `mpg` against displacement (`disp`), horsepower (`hp`), rear axle ratio (`drat`), and weight in 1000 lbs (`wt`). 
```{r lesson36a}
my.model<-lm(mpg~disp+hp+drat+wt,data=mtcars)
summary(my.model)
```

$$
\E(\text{mpg})=29.15+0.004*\text{disp}-0.035*\text{hp}+1.768*\text{drat}-3.480*\text{wt}
$$

Each coefficient represents the expected increase in `mpg` for a unit increase in the respective variable, leaving all other variables constant. 

b) Given your model, what is the expected mpg for a vehicle with a displacement of 170, a horsepower of 100, a `drat` of 3.80 and a wt of 2,900 lbs. Construct a 95% confidence interval and prediction interval for that expected mpg. 
```{r lesson36b}
predict(my.model,newdata=data.frame(disp=170,hp=100,drat=3.8,wt=2.9),interval="confidence")
predict(my.model,newdata=data.frame(disp=170,hp=100,drat=3.8,wt=2.9),interval="prediction")
```






&nbsp;

\indent 2. Is that the best model for predicting mpg? With your group, try a variety of different models. You could explore higher order terms or even interactions. One place to start is my using the `pairs()` function on `mtcars` to plot a large pairwise scatterplot. How high could you get adjusted $R$-squared? Keep in mind that is only one measure of fit. 

Answers will vary, but I tried this and got 0.8694. 
```{r lesson36c}
summary(lm(mpg~disp+I(disp^2)+hp+I(hp^2)+wt,data=mtcars))
```



