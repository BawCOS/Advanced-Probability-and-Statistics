---
title: "Lesson 2 Applications"
author: "Lt Col Ken Horton"
date: "August ??, 2019"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(prob)
```

\newcommand{\E}{\mbox{E}}
\newcommand{\Var}{\mbox{Var}}
\newcommand{\Cov}{\mbox{Cov}}
\newcommand{\Prob}{\mbox{P}}
\newcommand*\diff{\mathop{}\!\mathrm{d}}

# Exercises

\indent 1. Let $A$, $B$ and $C$ be events such that $\Prob(A)=0.5$, $\Prob(B)=0.3$, and $\Prob(C)=0.4$. Also, we know that $\Prob(A \cap B)=0.2$, $\Prob(B \cap C)=0.12$, $\Prob(A \cap C)=0.1$, and $\Prob(A \cap B \cap C)=0.05$. Find the following: 

  a) $\Prob(A\cup B)$
$$
\Prob(A\cup B) = \Prob(A)+\Prob(B)-\Prob(A\cap B)= 0.5+0.3-0.2 = 0.6
$$

  b) $\Prob(A\cup B \cup C)$
$$
\Prob(A\cup B \cup C) = \Prob(A)+\Prob(B)+\Prob(C)-\Prob(A\cap B)-\Prob(A\cap C)-\Prob(B\cap C)+\Prob(A\cap B \cap C)
$$
$$
= 0.5+0.3+0.4-0.2-0.12-0.1+0.05 = 0.83
$$

  c) $\Prob(B'\cap C')$
$$
\Prob(B'\cap C')=\Prob((B\cup C)') = 1-\Prob(B\cup C) = 1-[\Prob(B)+\Prob(C)-\Prob(B\cap C)]
$$
$$
= 1-(0.3+0.4-0.12) = 0.42
$$

  d) $\Prob(A\cup (B\cap C))$
$$
\Prob(A\cup (B\cap C)) = \Prob(A)+\Prob(B\cap C) -\Prob(A\cap B \cap C) = 0.5+0.12-0.05 = 0.57
$$

  e) $\Prob((A\cup B \cup C)\cap (A\cap B \cap C)')$
$$
\Prob((A\cup B \cup C)\cap (A\cap B \cap C)')=\Prob(A\cup B \cup C)-\Prob(A\cap B \cap C) = 0.83-0.05 = 0.78
$$

  f) Advanced: Find $\Prob(A|B)$, the probability of $A$ given we know $B$ has occurred. 
$$
\Prob(A|B)=\frac{\Prob(A \cap B)}{\Prob(B)} = \frac{0.2}{0.3}=0.667
$$

\indent 2. Consider Example 2.3 in the reading. What is the probability that the family has at least one boy? 
$$
\Prob(\mbox{at least one boy})=1-\Prob(\mbox{no boys})=1-\Prob(\mbox{GGG})=1-\frac{1}{8} = 0.875
$$



\indent 3. The Birthday Problem. 

a) Suppose there are $n=20$ people in a classroom. What is the probability that at least two people share a birthday? Assume only 365 days in a year and assume that all birthdays are equally likely. 
$$
\Prob(\mbox{at least two people share bday})=1-\Prob(\mbox{all unique bdays}) = 1-\frac{365 \cdot 364 \cdot ... \cdot 346}{365^{20}} = 0.4114
$$



b) In `R`, find the probability that at least two people share a birthday for each value of $n$ from 1 to 80. Plot these probabilities with $n$ on the $x$-axis and probability on the $y$-axis. At what value of $n$ would the probability be at least 95%? 

Generalizing,
$$
\Prob(\mbox{at least two people share bday})=1-\Prob(\mbox{all unique bdays}) = 1-\frac{365 \cdot 364 \cdot ... \cdot (365-n+1)}{365^n}
$$
```{r lesson2app1}
n<-1:80
prob<-sapply(n, function(x) 1-prod(365:(365-x+1))/(365^x))
plot(n,prob)
n[prob>=0.95][1]
```

